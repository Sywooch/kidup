!function($){$.fn.yiiGridView=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?($.error("Method "+method+" does not exist on jQuery.yiiGridView"),!1):methods.init.apply(this,arguments)};var defaults={filterUrl:void 0,filterSelector:void 0},gridData={},gridEvents={beforeFilter:"beforeFilter",afterFilter:"afterFilter"},methods={init:function(options){return this.each(function(){var $e=$(this),settings=$.extend({},defaults,options||{});gridData[$e.attr("id")]={settings:settings};var enterPressed=!1;$(document).off("change.yiiGridView keydown.yiiGridView",settings.filterSelector).on("change.yiiGridView keydown.yiiGridView",settings.filterSelector,function(event){if("keydown"===event.type){if(13!==event.keyCode)return;enterPressed=!0}else if(enterPressed)return void(enterPressed=!1);return methods.applyFilter.apply($e),!1})})},applyFilter:function(){var event,$grid=$(this),settings=gridData[$grid.attr("id")].settings,data={};$.each($(settings.filterSelector).serializeArray(),function(){data[this.name]=this.value}),$.each(yii.getQueryParams(settings.filterUrl),function(name,value){void 0===data[name]&&(data[name]=value)});var pos=settings.filterUrl.indexOf("?"),url=0>pos?settings.filterUrl:settings.filterUrl.substring(0,pos);$grid.find("form.gridview-filter-form").remove();var $form=$('<form action="'+url+'" method="get" class="gridview-filter-form" style="display:none" data-pjax></form>').appendTo($grid);$.each(data,function(name,value){$form.append($('<input type="hidden" name="t" value="" />').attr("name",name).val(value))}),event=$.Event(gridEvents.beforeFilter),$grid.trigger(event),event.result!==!1&&($form.submit(),$grid.trigger(gridEvents.afterFilter))},setSelectionColumn:function(options){var $grid=$(this),id=$(this).attr("id");if(gridData[id].selectionColumn=options.name,options.multiple){var checkAll="#"+id+" input[name='"+options.checkAll+"']",inputs="#"+id+" input[name='"+options.name+"']";$(document).off("click.yiiGridView",checkAll).on("click.yiiGridView",checkAll,function(){$grid.find("input[name='"+options.name+"']:enabled").prop("checked",this.checked)}),$(document).off("click.yiiGridView",inputs+":enabled").on("click.yiiGridView",inputs+":enabled",function(){var all=$grid.find("input[name='"+options.name+"']").length==$grid.find("input[name='"+options.name+"']:checked").length;$grid.find("input[name='"+options.checkAll+"']").prop("checked",all)})}},getSelectedRows:function(){var $grid=$(this),data=gridData[$grid.attr("id")],keys=[];return data.selectionColumn&&$grid.find("input[name='"+data.selectionColumn+"']:checked").each(function(){keys.push($(this).parent().closest("tr").data("key"))}),keys},destroy:function(){return this.each(function(){$(window).unbind(".yiiGridView"),$(this).removeData("yiiGridView")})},data:function(){var id=$(this).attr("id");return gridData[id]}}}(window.jQuery),$("#menu-search-form").on("submit",function(event){event.preventDefault();var vals=[],val=$("#menu-search-autocomplete").val();""==val&&(val=" "),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(position){var geocoder=new google.maps.Geocoder,latlng={lat:parseFloat(position.coords.latitude),lng:parseFloat(position.coords.longitude)};vals.push("search-filter[latitude]="+latlng.lat),vals.push("search-filter[longitude]="+latlng.lng),geocoder.geocode({location:latlng},function(results,status){if(status===google.maps.GeocoderStatus.OK&&results.length>0){var result=results[0],location=result.formatted_address;vals.push("search-filter[location]="+location),window.location=event.currentTarget.action+"/"+val+"?"+vals.join("&")}})}):window.location=event.currentTarget.action+"/"+val+"?"+vals.join("&"),window.location=event.currentTarget.action+"/"+val+"?"+vals.join("&")}),jQuery(function($){$.fn.authchoice=function(options){return options=$.extend({popup:{resizable:"yes",scrollbars:"no",toolbar:"no",menubar:"no",location:"no",directories:"no",status:"yes",width:450,height:380}},options),this.each(function(){var $container=$(this);$container.find("a").on("click",function(e){e.preventDefault();var authChoicePopup=$container.data("authChoicePopup");authChoicePopup&&authChoicePopup.close();var url=this.href,popupOptions=$.extend({},options.popup),localPopupWidth=this.getAttribute("data-popup-width");localPopupWidth&&(popupOptions.width=localPopupWidth);var localPopupHeight=this.getAttribute("data-popup-height");localPopupWidth&&(popupOptions.height=localPopupHeight),popupOptions.left=(window.screen.width-popupOptions.width)/2,popupOptions.top=(window.screen.height-popupOptions.height)/2;var popupFeatureParts=[];for(var propName in popupOptions)popupOptions.hasOwnProperty(propName)&&popupFeatureParts.push(propName+"="+popupOptions[propName]);var popupFeature=popupFeatureParts.join(",");authChoicePopup=window.open(url,"yii_auth_choice",popupFeature),authChoicePopup.focus(),$container.data("authChoicePopup",authChoicePopup)})})}}),function(root,factory){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(a0){return root.Bloodhound=factory(a0)}):"object"==typeof exports?module.exports=factory(require("jquery")):root.Bloodhound=factory(jQuery)}(this,function($){var _=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(str){return!str||/^\s*$/.test(str)},escapeRegExChars:function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(obj){return"string"==typeof obj},isNumber:function(obj){return"number"==typeof obj},isArray:$.isArray,isFunction:$.isFunction,isObject:$.isPlainObject,isUndefined:function(obj){return"undefined"==typeof obj},isElement:function(obj){return!(!obj||1!==obj.nodeType)},isJQuery:function(obj){return obj instanceof $},toStr:function(s){return _.isUndefined(s)||null===s?"":s+""},bind:$.proxy,each:function(collection,cb){function reverseArgs(index,value){return cb(value,index)}$.each(collection,reverseArgs)},map:$.map,filter:$.grep,every:function(obj,test){var result=!0;return obj?($.each(obj,function(key,val){return(result=test.call(null,val,key,obj))?void 0:!1}),!!result):result},some:function(obj,test){var result=!1;return obj?($.each(obj,function(key,val){return(result=test.call(null,val,key,obj))?!1:void 0}),!!result):result},mixin:$.extend,identity:function(x){return x},clone:function(obj){return $.extend(!0,{},obj)},getIdGenerator:function(){var counter=0;return function(){return counter++}},templatify:function(obj){function template(){return String(obj)}return $.isFunction(obj)?obj:template},defer:function(fn){setTimeout(fn,0)},debounce:function(func,wait,immediate){var timeout,result;return function(){var later,callNow,context=this,args=arguments;return later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout,clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&(result=func.apply(context,args)),result}},throttle:function(func,wait){var context,args,timeout,result,previous,later;return previous=0,later=function(){previous=new Date,timeout=null,result=func.apply(context,args)},function(){var now=new Date,remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args)):timeout||(timeout=setTimeout(later,remaining)),result}},stringify:function(val){return _.isString(val)?val:JSON.stringify(val)},noop:function(){}}}(),VERSION="0.11.1",tokenizers=function(){"use strict";function whitespace(str){return str=_.toStr(str),str?str.split(/\s+/):[]}function nonword(str){return str=_.toStr(str),str?str.split(/\W+/):[]}function getObjTokenizer(tokenizer){return function(keys){return keys=_.isArray(keys)?keys:[].slice.call(arguments,0),function(o){var tokens=[];return _.each(keys,function(k){tokens=tokens.concat(tokenizer(_.toStr(o[k])))}),tokens}}}return{nonword:nonword,whitespace:whitespace,obj:{nonword:getObjTokenizer(nonword),whitespace:getObjTokenizer(whitespace)}}}(),LruCache=function(){"use strict";function LruCache(maxSize){this.maxSize=_.isNumber(maxSize)?maxSize:100,this.reset(),this.maxSize<=0&&(this.set=this.get=$.noop)}function List(){this.head=this.tail=null}function Node(key,val){this.key=key,this.val=val,this.prev=this.next=null}return _.mixin(LruCache.prototype,{set:function(key,val){var node,tailItem=this.list.tail;this.size>=this.maxSize&&(this.list.remove(tailItem),delete this.hash[tailItem.key],this.size--),(node=this.hash[key])?(node.val=val,this.list.moveToFront(node)):(node=new Node(key,val),this.list.add(node),this.hash[key]=node,this.size++)},get:function(key){var node=this.hash[key];return node?(this.list.moveToFront(node),node.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new List}}),_.mixin(List.prototype,{add:function(node){this.head&&(node.next=this.head,this.head.prev=node),this.head=node,this.tail=this.tail||node},remove:function(node){node.prev?node.prev.next=node.next:this.head=node.next,node.next?node.next.prev=node.prev:this.tail=node.prev},moveToFront:function(node){this.remove(node),this.add(node)}}),LruCache}(),PersistentStorage=function(){"use strict";function PersistentStorage(namespace,override){this.prefix=["__",namespace,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+_.escapeRegExChars(this.prefix)),this.ls=override||LOCAL_STORAGE,!this.ls&&this._noop()}function now(){return(new Date).getTime()}function encode(val){return JSON.stringify(_.isUndefined(val)?null:val)}function decode(val){return $.parseJSON(val)}function gatherMatchingKeys(keyMatcher){var i,key,keys=[],len=LOCAL_STORAGE.length;for(i=0;len>i;i++)(key=LOCAL_STORAGE.key(i)).match(keyMatcher)&&keys.push(key.replace(keyMatcher,""));return keys}var LOCAL_STORAGE;try{LOCAL_STORAGE=window.localStorage,LOCAL_STORAGE.setItem("~~~","!"),LOCAL_STORAGE.removeItem("~~~")}catch(err){LOCAL_STORAGE=null}return _.mixin(PersistentStorage.prototype,{_prefix:function(key){return this.prefix+key},_ttlKey:function(key){return this._prefix(key)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=_.noop},_safeSet:function(key,val){try{this.ls.setItem(key,val)}catch(err){"QuotaExceededError"===err.name&&(this.clear(),this._noop())}},get:function(key){return this.isExpired(key)&&this.remove(key),decode(this.ls.getItem(this._prefix(key)))},set:function(key,val,ttl){return _.isNumber(ttl)?this._safeSet(this._ttlKey(key),encode(now()+ttl)):this.ls.removeItem(this._ttlKey(key)),this._safeSet(this._prefix(key),encode(val))},remove:function(key){return this.ls.removeItem(this._ttlKey(key)),this.ls.removeItem(this._prefix(key)),this},clear:function(){var i,keys=gatherMatchingKeys(this.keyMatcher);for(i=keys.length;i--;)this.remove(keys[i]);return this},isExpired:function(key){var ttl=decode(this.ls.getItem(this._ttlKey(key)));return _.isNumber(ttl)&&now()>ttl?!0:!1}}),PersistentStorage}(),Transport=function(){"use strict";function Transport(o){o=o||{},this.cancelled=!1,this.lastReq=null,this._send=o.transport,this._get=o.limiter?o.limiter(this._get):this._get,this._cache=o.cache===!1?new LruCache(0):sharedCache}var pendingRequestsCount=0,pendingRequests={},maxPendingRequests=6,sharedCache=new LruCache(10);return Transport.setMaxPendingRequests=function(num){maxPendingRequests=num},Transport.resetCache=function(){sharedCache.reset()},_.mixin(Transport.prototype,{_fingerprint:function(o){return o=o||{},o.url+o.type+$.param(o.data||{})},_get:function(o,cb){function done(resp){cb(null,resp),that._cache.set(fingerprint,resp)}function fail(){cb(!0)}function always(){pendingRequestsCount--,delete pendingRequests[fingerprint],that.onDeckRequestArgs&&(that._get.apply(that,that.onDeckRequestArgs),that.onDeckRequestArgs=null)}var fingerprint,jqXhr,that=this;fingerprint=this._fingerprint(o),this.cancelled||fingerprint!==this.lastReq||((jqXhr=pendingRequests[fingerprint])?jqXhr.done(done).fail(fail):maxPendingRequests>pendingRequestsCount?(pendingRequestsCount++,pendingRequests[fingerprint]=this._send(o).done(done).fail(fail).always(always)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(o,cb){var resp,fingerprint;cb=cb||$.noop,o=_.isString(o)?{url:o}:o||{},fingerprint=this._fingerprint(o),this.cancelled=!1,this.lastReq=fingerprint,(resp=this._cache.get(fingerprint))?cb(null,resp):this._get(o,cb)},cancel:function(){this.cancelled=!0}}),Transport}(),SearchIndex=window.SearchIndex=function(){"use strict";function SearchIndex(o){o=o||{},o.datumTokenizer&&o.queryTokenizer||$.error("datumTokenizer and queryTokenizer are both required"),this.identify=o.identify||_.stringify,this.datumTokenizer=o.datumTokenizer,this.queryTokenizer=o.queryTokenizer,this.reset()}function normalizeTokens(tokens){return tokens=_.filter(tokens,function(token){return!!token}),tokens=_.map(tokens,function(token){return token.toLowerCase()})}function newNode(){var node={};return node[IDS]=[],node[CHILDREN]={},node}function unique(array){for(var seen={},uniques=[],i=0,len=array.length;len>i;i++)seen[array[i]]||(seen[array[i]]=!0,uniques.push(array[i]));return uniques}function getIntersection(arrayA,arrayB){var ai=0,bi=0,intersection=[];arrayA=arrayA.sort(),arrayB=arrayB.sort();for(var lenArrayA=arrayA.length,lenArrayB=arrayB.length;lenArrayA>ai&&lenArrayB>bi;)arrayA[ai]<arrayB[bi]?ai++:arrayA[ai]>arrayB[bi]?bi++:(intersection.push(arrayA[ai]),ai++,bi++);return intersection}var CHILDREN="c",IDS="i";return _.mixin(SearchIndex.prototype,{bootstrap:function(o){this.datums=o.datums,this.trie=o.trie},add:function(data){var that=this;data=_.isArray(data)?data:[data],_.each(data,function(datum){var id,tokens;that.datums[id=that.identify(datum)]=datum,tokens=normalizeTokens(that.datumTokenizer(datum)),_.each(tokens,function(token){var node,chars,ch;for(node=that.trie,chars=token.split("");ch=chars.shift();)node=node[CHILDREN][ch]||(node[CHILDREN][ch]=newNode()),node[IDS].push(id)})})},get:function(ids){var that=this;return _.map(ids,function(id){return that.datums[id]})},search:function(query){var tokens,matches,that=this;return tokens=normalizeTokens(this.queryTokenizer(query)),_.each(tokens,function(token){var node,chars,ch,ids;if(matches&&0===matches.length)return!1;for(node=that.trie,chars=token.split("");node&&(ch=chars.shift());)node=node[CHILDREN][ch];return node&&0===chars.length?(ids=node[IDS].slice(0),void(matches=matches?getIntersection(matches,ids):ids)):(matches=[],!1)}),matches?_.map(unique(matches),function(id){return that.datums[id]}):[]},all:function(){var values=[];for(var key in this.datums)values.push(this.datums[key]);return values},reset:function(){this.datums={},this.trie=newNode()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),SearchIndex}(),Prefetch=function(){"use strict";function Prefetch(o){this.url=o.url,this.ttl=o.ttl,this.cache=o.cache,this.prepare=o.prepare,this.transform=o.transform,this.transport=o.transport,this.thumbprint=o.thumbprint,this.storage=new PersistentStorage(o.cacheKey)}var keys;return keys={data:"data",protocol:"protocol",thumbprint:"thumbprint"},_.mixin(Prefetch.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(data){this.cache&&(this.storage.set(keys.data,data,this.ttl),this.storage.set(keys.protocol,location.protocol,this.ttl),this.storage.set(keys.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var isExpired,stored={};return this.cache?(stored.data=this.storage.get(keys.data),stored.protocol=this.storage.get(keys.protocol),stored.thumbprint=this.storage.get(keys.thumbprint),isExpired=stored.thumbprint!==this.thumbprint||stored.protocol!==location.protocol,stored.data&&!isExpired?stored.data:null):null},fromNetwork:function(cb){function onError(){cb(!0)}function onResponse(resp){cb(null,that.transform(resp))}var settings,that=this;cb&&(settings=this.prepare(this._settings()),this.transport(settings).fail(onError).done(onResponse))},clear:function(){return this.storage.clear(),this}}),Prefetch}(),Remote=function(){"use strict";function Remote(o){this.url=o.url,this.prepare=o.prepare,this.transform=o.transform,this.transport=new Transport({cache:o.cache,limiter:o.limiter,transport:o.transport})}return _.mixin(Remote.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(query,cb){function onResponse(err,resp){cb(err?[]:that.transform(resp))}var settings,that=this;if(cb)return query=query||"",settings=this.prepare(query,this._settings()),this.transport.get(settings,onResponse)},cancelLastRequest:function(){this.transport.cancel()}}),Remote}(),oParser=function(){"use strict";function parsePrefetch(o){var defaults;return o?(defaults={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:_.identity,transform:_.identity,transport:null},o=_.isString(o)?{url:o}:o,o=_.mixin(defaults,o),!o.url&&$.error("prefetch requires url to be set"),o.transform=o.filter||o.transform,o.cacheKey=o.cacheKey||o.url,o.thumbprint=VERSION+o.thumbprint,o.transport=o.transport?callbackToDeferred(o.transport):$.ajax,o):null}function parseRemote(o){var defaults;if(o)return defaults={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:_.identity,transport:null},o=_.isString(o)?{url:o}:o,o=_.mixin(defaults,o),!o.url&&$.error("remote requires url to be set"),o.transform=o.filter||o.transform,o.prepare=toRemotePrepare(o),o.limiter=toLimiter(o),o.transport=o.transport?callbackToDeferred(o.transport):$.ajax,delete o.replace,delete o.wildcard,delete o.rateLimitBy,delete o.rateLimitWait,o}function toRemotePrepare(o){function prepareByReplace(query,settings){return settings.url=replace(settings.url,query),settings}function prepareByWildcard(query,settings){return settings.url=settings.url.replace(wildcard,encodeURIComponent(query)),settings}function idenityPrepare(query,settings){return settings}var prepare,replace,wildcard;return prepare=o.prepare,replace=o.replace,wildcard=o.wildcard,prepare?prepare:prepare=replace?prepareByReplace:o.wildcard?prepareByWildcard:idenityPrepare}function toLimiter(o){function debounce(wait){return function(fn){return _.debounce(fn,wait)}}function throttle(wait){return function(fn){return _.throttle(fn,wait)}}var limiter,method,wait;return limiter=o.limiter,method=o.rateLimitBy,wait=o.rateLimitWait,limiter||(limiter=/^throttle$/i.test(method)?throttle(wait):debounce(wait)),limiter}function callbackToDeferred(fn){return function(o){function onSuccess(resp){_.defer(function(){deferred.resolve(resp)})}function onError(err){_.defer(function(){deferred.reject(err)})}var deferred=$.Deferred();return fn(o,onSuccess,onError),deferred}}return function(o){var defaults,sorter;return defaults={initialize:!0,identify:_.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},o=_.mixin(defaults,o||{}),!o.datumTokenizer&&$.error("datumTokenizer is required"),!o.queryTokenizer&&$.error("queryTokenizer is required"),sorter=o.sorter,o.sorter=sorter?function(x){return x.sort(sorter)}:_.identity,o.local=_.isFunction(o.local)?o.local():o.local,o.prefetch=parsePrefetch(o.prefetch),o.remote=parseRemote(o.remote),o}}(),Bloodhound=function(){"use strict";function Bloodhound(o){o=oParser(o),this.sorter=o.sorter,this.identify=o.identify,this.sufficient=o.sufficient,this.local=o.local,this.remote=o.remote?new Remote(o.remote):null,this.prefetch=o.prefetch?new Prefetch(o.prefetch):null,this.index=new SearchIndex({identify:this.identify,datumTokenizer:o.datumTokenizer,queryTokenizer:o.queryTokenizer}),o.initialize!==!1&&this.initialize()}var old;return old=window&&window.Bloodhound,Bloodhound.noConflict=function(){return window&&(window.Bloodhound=old),Bloodhound},Bloodhound.tokenizers=tokenizers,_.mixin(Bloodhound.prototype,{__ttAdapter:function(){function withAsync(query,sync,async){return that.search(query,sync,async)}function withoutAsync(query,sync){return that.search(query,sync)}var that=this;return this.remote?withAsync:withoutAsync},_loadPrefetch:function(){function done(err,data){return err?deferred.reject():(that.add(data),that.prefetch.store(that.index.serialize()),void deferred.resolve())}var deferred,serialized,that=this;return deferred=$.Deferred(),this.prefetch?(serialized=this.prefetch.fromCache())?(this.index.bootstrap(serialized),deferred.resolve()):this.prefetch.fromNetwork(done):deferred.resolve(),deferred.promise()},_initialize:function(){function addLocalToIndex(){that.add(that.local)}var that=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(addLocalToIndex),this.initPromise},initialize:function(force){return!this.initPromise||force?this._initialize():this.initPromise},add:function(data){return this.index.add(data),this},get:function(ids){return ids=_.isArray(ids)?ids:[].slice.call(arguments),this.index.get(ids)},search:function(query,sync,async){function processRemote(remote){var nonDuplicates=[];_.each(remote,function(r){!_.some(local,function(l){return that.identify(r)===that.identify(l)})&&nonDuplicates.push(r)}),async&&async(nonDuplicates)}var local,that=this;return local=this.sorter(this.index.search(query)),sync(this.remote?local.slice():local),this.remote&&local.length<this.sufficient?this.remote.get(query,processRemote):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return Transport.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),Bloodhound}();return Bloodhound}),function(root,factory){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(a0){return factory(a0)}):"object"==typeof exports?module.exports=factory(require("jquery")):factory(jQuery)}(this,function($){var _=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(str){return!str||/^\s*$/.test(str)},escapeRegExChars:function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(obj){return"string"==typeof obj},isNumber:function(obj){return"number"==typeof obj},isArray:$.isArray,isFunction:$.isFunction,isObject:$.isPlainObject,isUndefined:function(obj){return"undefined"==typeof obj},isElement:function(obj){return!(!obj||1!==obj.nodeType)},isJQuery:function(obj){return obj instanceof $},toStr:function(s){return _.isUndefined(s)||null===s?"":s+""},bind:$.proxy,each:function(collection,cb){function reverseArgs(index,value){return cb(value,index)}$.each(collection,reverseArgs)},map:$.map,filter:$.grep,every:function(obj,test){var result=!0;return obj?($.each(obj,function(key,val){return(result=test.call(null,val,key,obj))?void 0:!1}),!!result):result},some:function(obj,test){var result=!1;return obj?($.each(obj,function(key,val){return(result=test.call(null,val,key,obj))?!1:void 0}),!!result):result},mixin:$.extend,identity:function(x){return x},clone:function(obj){return $.extend(!0,{},obj)},getIdGenerator:function(){var counter=0;return function(){return counter++}},templatify:function(obj){function template(){return String(obj)}return $.isFunction(obj)?obj:template},defer:function(fn){setTimeout(fn,0)},debounce:function(func,wait,immediate){var timeout,result;return function(){var later,callNow,context=this,args=arguments;return later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout,clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&(result=func.apply(context,args)),result}},throttle:function(func,wait){var context,args,timeout,result,previous,later;return previous=0,later=function(){previous=new Date,timeout=null,result=func.apply(context,args)},function(){var now=new Date,remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args)):timeout||(timeout=setTimeout(later,remaining)),result}},stringify:function(val){return _.isString(val)?val:JSON.stringify(val)},noop:function(){}}}(),WWW=function(){"use strict";function build(o){var www,classes;return classes=_.mixin({},defaultClassNames,o),www={css:buildCss(),classes:classes,html:buildHtml(classes),selectors:buildSelectors(classes)},{css:www.css,html:www.html,classes:www.classes,selectors:www.selectors,mixin:function(o){_.mixin(o,www)}}}function buildHtml(c){return{wrapper:'<span class="'+c.wrapper+'"></span>',menu:'<div class="'+c.menu+'"></div>'}}function buildSelectors(classes){var selectors={};return _.each(classes,function(v,k){selectors[k]="."+v}),selectors}function buildCss(){var css={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return _.isMsie()&&_.mixin(css.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),css}var defaultClassNames={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return build}(),EventBus=function(){"use strict";function EventBus(o){o&&o.el||$.error("EventBus initialized without el"),this.$el=$(o.el)}var namespace,deprecationMap;return namespace="typeahead:",deprecationMap={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},_.mixin(EventBus.prototype,{_trigger:function(type,args){var $e;return $e=$.Event(namespace+type),(args=args||[]).unshift($e),this.$el.trigger.apply(this.$el,args),$e},before:function(type){var args,$e;return args=[].slice.call(arguments,1),$e=this._trigger("before"+type,args),$e.isDefaultPrevented()},trigger:function(type){var deprecatedType;this._trigger(type,[].slice.call(arguments,1)),(deprecatedType=deprecationMap[type])&&this._trigger(deprecatedType,[].slice.call(arguments,1))}}),EventBus}(),EventEmitter=function(){"use strict";function on(method,types,cb,context){var type;if(!cb)return this;for(types=types.split(splitter),cb=context?bindContext(cb,context):cb,this._callbacks=this._callbacks||{};type=types.shift();)this._callbacks[type]=this._callbacks[type]||{sync:[],async:[]},this._callbacks[type][method].push(cb);return this}function onAsync(types,cb,context){return on.call(this,"async",types,cb,context)}function onSync(types,cb,context){return on.call(this,"sync",types,cb,context)}function off(types){var type;if(!this._callbacks)return this;for(types=types.split(splitter);type=types.shift();)delete this._callbacks[type];return this}function trigger(types){var type,callbacks,args,syncFlush,asyncFlush;if(!this._callbacks)return this;for(types=types.split(splitter),args=[].slice.call(arguments,1);(type=types.shift())&&(callbacks=this._callbacks[type]);)syncFlush=getFlush(callbacks.sync,this,[type].concat(args)),asyncFlush=getFlush(callbacks.async,this,[type].concat(args)),syncFlush()&&nextTick(asyncFlush);return this}function getFlush(callbacks,context,args){function flush(){for(var cancelled,i=0,len=callbacks.length;!cancelled&&len>i;i+=1)cancelled=callbacks[i].apply(context,args)===!1;return!cancelled}return flush}function getNextTick(){var nextTickFn;return nextTickFn=window.setImmediate?function(fn){setImmediate(function(){fn()})}:function(fn){setTimeout(function(){fn()},0)}}function bindContext(fn,context){return fn.bind?fn.bind(context):function(){fn.apply(context,[].slice.call(arguments,0))}}var splitter=/\s+/,nextTick=getNextTick();return{onSync:onSync,onAsync:onAsync,off:off,trigger:trigger}}(),highlight=function(doc){"use strict";function getRegex(patterns,caseSensitive,wordsOnly){for(var regexStr,escapedPatterns=[],i=0,len=patterns.length;len>i;i++)escapedPatterns.push(_.escapeRegExChars(patterns[i]));return regexStr=wordsOnly?"\\b("+escapedPatterns.join("|")+")\\b":"("+escapedPatterns.join("|")+")",caseSensitive?new RegExp(regexStr):new RegExp(regexStr,"i")}var defaults={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(o){function hightlightTextNode(textNode){var match,patternNode,wrapperNode;return(match=regex.exec(textNode.data))&&(wrapperNode=doc.createElement(o.tagName),o.className&&(wrapperNode.className=o.className),patternNode=textNode.splitText(match.index),patternNode.splitText(match[0].length),wrapperNode.appendChild(patternNode.cloneNode(!0)),textNode.parentNode.replaceChild(wrapperNode,patternNode)),!!match}function traverse(el,hightlightTextNode){for(var childNode,TEXT_NODE_TYPE=3,i=0;i<el.childNodes.length;i++)childNode=el.childNodes[i],childNode.nodeType===TEXT_NODE_TYPE?i+=hightlightTextNode(childNode)?1:0:traverse(childNode,hightlightTextNode)}var regex;o=_.mixin({},defaults,o),o.node&&o.pattern&&(o.pattern=_.isArray(o.pattern)?o.pattern:[o.pattern],regex=getRegex(o.pattern,o.caseSensitive,o.wordsOnly),traverse(o.node,hightlightTextNode))}}(window.document),Input=function(){"use strict";function Input(o,www){o=o||{},o.input||$.error("input is missing"),www.mixin(this),this.$hint=$(o.hint),this.$input=$(o.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=buildOverflowHelper(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=_.noop)}function buildOverflowHelper($input){return $('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:$input.css("font-family"),fontSize:$input.css("font-size"),fontStyle:$input.css("font-style"),fontVariant:$input.css("font-variant"),fontWeight:$input.css("font-weight"),wordSpacing:$input.css("word-spacing"),letterSpacing:$input.css("letter-spacing"),textIndent:$input.css("text-indent"),textRendering:$input.css("text-rendering"),textTransform:$input.css("text-transform")}).insertAfter($input)}function areQueriesEquivalent(a,b){return Input.normalizeQuery(a)===Input.normalizeQuery(b)}function withModifier($e){return $e.altKey||$e.ctrlKey||$e.metaKey||$e.shiftKey}var specialKeyCodeMap;return specialKeyCodeMap={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},Input.normalizeQuery=function(str){return _.toStr(str).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},_.mixin(Input.prototype,EventEmitter,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function($e){var keyName=specialKeyCodeMap[$e.which||$e.keyCode];this._managePreventDefault(keyName,$e),keyName&&this._shouldTrigger(keyName,$e)&&this.trigger(keyName+"Keyed",$e)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(keyName,$e){var preventDefault;switch(keyName){case"up":case"down":preventDefault=!withModifier($e);break;default:preventDefault=!1}preventDefault&&$e.preventDefault()},_shouldTrigger:function(keyName,$e){var trigger;switch(keyName){case"tab":trigger=!withModifier($e);break;default:trigger=!0}return trigger},_checkLanguageDirection:function(){var dir=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==dir&&(this.dir=dir,this.$hint.attr("dir",dir),this.trigger("langDirChanged",dir));
},_setQuery:function(val,silent){var areEquivalent,hasDifferentWhitespace;areEquivalent=areQueriesEquivalent(val,this.query),hasDifferentWhitespace=areEquivalent?this.query.length!==val.length:!1,this.query=val,silent||areEquivalent?!silent&&hasDifferentWhitespace&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var onBlur,onFocus,onKeydown,onInput,that=this;return onBlur=_.bind(this._onBlur,this),onFocus=_.bind(this._onFocus,this),onKeydown=_.bind(this._onKeydown,this),onInput=_.bind(this._onInput,this),this.$input.on("blur.tt",onBlur).on("focus.tt",onFocus).on("keydown.tt",onKeydown),!_.isMsie()||_.isMsie()>9?this.$input.on("input.tt",onInput):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function($e){specialKeyCodeMap[$e.which||$e.keyCode]||_.defer(_.bind(that._onInput,that,$e))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(val,silent){this.setInputValue(val),this._setQuery(val,silent)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(value){this.$input.val(value),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(value){this.$hint.val(value)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var val,hint,valIsPrefixOfHint,isValid;val=this.getInputValue(),hint=this.getHint(),valIsPrefixOfHint=val!==hint&&0===hint.indexOf(val),isValid=""!==val&&valIsPrefixOfHint&&!this.hasOverflow(),!isValid&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var constraint=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=constraint},isCursorAtEnd:function(){var valueLength,selectionStart,range;return valueLength=this.$input.val().length,selectionStart=this.$input[0].selectionStart,_.isNumber(selectionStart)?selectionStart===valueLength:document.selection?(range=document.selection.createRange(),range.moveStart("character",-valueLength),valueLength===range.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=$("<div>")}}),Input}(),Dataset=function(){"use strict";function Dataset(o,www){o=o||{},o.templates=o.templates||{},o.templates.notFound=o.templates.notFound||o.templates.empty,o.source||$.error("missing source"),o.node||$.error("missing node"),o.name&&!isValidName(o.name)&&$.error("invalid dataset name: "+o.name),www.mixin(this),this.highlight=!!o.highlight,this.name=o.name||nameGenerator(),this.limit=o.limit||5,this.displayFn=getDisplayFn(o.display||o.displayKey),this.templates=getTemplates(o.templates,this.displayFn),this.source=o.source.__ttAdapter?o.source.__ttAdapter():o.source,this.async=_.isUndefined(o.async)?this.source.length>2:!!o.async,this._resetLastSuggestion(),this.$el=$(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function getDisplayFn(display){function displayFn(obj){return obj[display]}return display=display||_.stringify,_.isFunction(display)?display:displayFn}function getTemplates(templates,displayFn){function suggestionTemplate(context){return $("<div>").text(displayFn(context))}return{notFound:templates.notFound&&_.templatify(templates.notFound),pending:templates.pending&&_.templatify(templates.pending),header:templates.header&&_.templatify(templates.header),footer:templates.footer&&_.templatify(templates.footer),suggestion:templates.suggestion||suggestionTemplate}}function isValidName(str){return/^[_a-zA-Z0-9-]+$/.test(str)}var keys,nameGenerator;return keys={val:"tt-selectable-display",obj:"tt-selectable-object"},nameGenerator=_.getIdGenerator(),Dataset.extractData=function(el){var $el=$(el);return $el.data(keys.obj)?{val:$el.data(keys.val)||"",obj:$el.data(keys.obj)||null}:null},_.mixin(Dataset.prototype,EventEmitter,{_overwrite:function(query,suggestions){suggestions=suggestions||[],suggestions.length?this._renderSuggestions(query,suggestions):this.async&&this.templates.pending?this._renderPending(query):!this.async&&this.templates.notFound?this._renderNotFound(query):this._empty(),this.trigger("rendered",this.name,suggestions,!1)},_append:function(query,suggestions){suggestions=suggestions||[],suggestions.length&&this.$lastSuggestion.length?this._appendSuggestions(query,suggestions):suggestions.length?this._renderSuggestions(query,suggestions):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(query),this.trigger("rendered",this.name,suggestions,!0)},_renderSuggestions:function(query,suggestions){var $fragment;$fragment=this._getSuggestionsFragment(query,suggestions),this.$lastSuggestion=$fragment.children().last(),this.$el.html($fragment).prepend(this._getHeader(query,suggestions)).append(this._getFooter(query,suggestions))},_appendSuggestions:function(query,suggestions){var $fragment,$lastSuggestion;$fragment=this._getSuggestionsFragment(query,suggestions),$lastSuggestion=$fragment.children().last(),this.$lastSuggestion.after($fragment),this.$lastSuggestion=$lastSuggestion},_renderPending:function(query){var template=this.templates.pending;this._resetLastSuggestion(),template&&this.$el.html(template({query:query,dataset:this.name}))},_renderNotFound:function(query){var template=this.templates.notFound;this._resetLastSuggestion(),template&&this.$el.html(template({query:query,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(query,suggestions){var fragment,that=this;return fragment=document.createDocumentFragment(),_.each(suggestions,function(suggestion){var $el,context;context=that._injectQuery(query,suggestion),$el=$(that.templates.suggestion(context)).data(keys.obj,suggestion).data(keys.val,that.displayFn(suggestion)).addClass(that.classes.suggestion+" "+that.classes.selectable),fragment.appendChild($el[0])}),this.highlight&&highlight({className:this.classes.highlight,node:fragment,pattern:query}),$(fragment)},_getFooter:function(query,suggestions){return this.templates.footer?this.templates.footer({query:query,suggestions:suggestions,dataset:this.name}):null},_getHeader:function(query,suggestions){return this.templates.header?this.templates.header({query:query,suggestions:suggestions,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=$()},_injectQuery:function(query,obj){return _.isObject(obj)?_.mixin({_query:query},obj):obj},update:function(query){function sync(suggestions){syncCalled||(syncCalled=!0,suggestions=(suggestions||[]).slice(0,that.limit),rendered=suggestions.length,that._overwrite(query,suggestions),rendered<that.limit&&that.async&&that.trigger("asyncRequested",query))}function async(suggestions){suggestions=suggestions||[],!canceled&&rendered<that.limit&&(that.cancel=$.noop,rendered+=suggestions.length,that._append(query,suggestions.slice(0,that.limit-rendered)),that.async&&that.trigger("asyncReceived",query))}var that=this,canceled=!1,syncCalled=!1,rendered=0;this.cancel(),this.cancel=function(){canceled=!0,that.cancel=$.noop,that.async&&that.trigger("asyncCanceled",query)},this.source(query,sync,async),!syncCalled&&sync([])},cancel:$.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=$("<div>")}}),Dataset}(),Menu=function(){"use strict";function Menu(o,www){function initializeDataset(oDataset){var node=that.$node.find(oDataset.node).first();return oDataset.node=node.length?node:$("<div>").appendTo(that.$node),new Dataset(oDataset,www)}var that=this;o=o||{},o.node||$.error("node is required"),www.mixin(this),this.$node=$(o.node),this.query=null,this.datasets=_.map(o.datasets,initializeDataset)}return _.mixin(Menu.prototype,EventEmitter,{_onSelectableClick:function($e){this.trigger("selectableClicked",$($e.currentTarget))},_onRendered:function(type,dataset,suggestions,async){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",dataset,suggestions,async)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function isDatasetEmpty(dataset){return dataset.isEmpty()}return _.every(this.datasets,isDatasetEmpty)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var $selectable=this.getActiveSelectable();$selectable&&$selectable.removeClass(this.classes.cursor)},_ensureVisible:function($el){var elTop,elBottom,nodeScrollTop,nodeHeight;elTop=$el.position().top,elBottom=elTop+$el.outerHeight(!0),nodeScrollTop=this.$node.scrollTop(),nodeHeight=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),0>elTop?this.$node.scrollTop(nodeScrollTop+elTop):elBottom>nodeHeight&&this.$node.scrollTop(nodeScrollTop+(elBottom-nodeHeight))},bind:function(){var onSelectableClick,that=this;return onSelectableClick=_.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,onSelectableClick),_.each(this.datasets,function(dataset){dataset.onSync("asyncRequested",that._propagate,that).onSync("asyncCanceled",that._propagate,that).onSync("asyncReceived",that._propagate,that).onSync("rendered",that._onRendered,that).onSync("cleared",that._onCleared,that)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(dir){this.$node.attr("dir",dir)},selectableRelativeToCursor:function(delta){var $selectables,$oldCursor,oldIndex,newIndex;return $oldCursor=this.getActiveSelectable(),$selectables=this._getSelectables(),oldIndex=$oldCursor?$selectables.index($oldCursor):-1,newIndex=oldIndex+delta,newIndex=(newIndex+1)%($selectables.length+1)-1,newIndex=-1>newIndex?$selectables.length-1:newIndex,-1===newIndex?null:$selectables.eq(newIndex)},setCursor:function($selectable){this._removeCursor(),($selectable=$selectable&&$selectable.first())&&($selectable.addClass(this.classes.cursor),this._ensureVisible($selectable))},getSelectableData:function($el){return $el&&$el.length?Dataset.extractData($el):null},getActiveSelectable:function(){var $selectable=this._getSelectables().filter(this.selectors.cursor).first();return $selectable.length?$selectable:null},getTopSelectable:function(){var $selectable=this._getSelectables().first();return $selectable.length?$selectable:null},update:function(query){function updateDataset(dataset){dataset.update(query)}var isValidUpdate=query!==this.query;return isValidUpdate&&(this.query=query,_.each(this.datasets,updateDataset)),isValidUpdate},empty:function(){function clearDataset(dataset){dataset.clear()}_.each(this.datasets,clearDataset),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function destroyDataset(dataset){dataset.destroy()}this.$node.off(".tt"),this.$node=$("<div>"),_.each(this.datasets,destroyDataset)}}),Menu}(),DefaultMenu=function(){"use strict";function DefaultMenu(){Menu.apply(this,[].slice.call(arguments,0))}var s=Menu.prototype;return _.mixin(DefaultMenu.prototype,Menu.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),s.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),s.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),s._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),s._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(dir){return this.$node.css("ltr"===dir?this.css.ltr:this.css.rtl),s.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),DefaultMenu}(),Typeahead=function(){"use strict";function Typeahead(o,www){var onFocused,onBlurred,onEnterKeyed,onTabKeyed,onEscKeyed,onUpKeyed,onDownKeyed,onLeftKeyed,onRightKeyed,onQueryChanged,onWhitespaceChanged;o=o||{},o.input||$.error("missing input"),o.menu||$.error("missing menu"),o.eventBus||$.error("missing event bus"),www.mixin(this),this.eventBus=o.eventBus,this.minLength=_.isNumber(o.minLength)?o.minLength:1,this.input=o.input,this.menu=o.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),onFocused=c(this,"activate","open","_onFocused"),onBlurred=c(this,"deactivate","_onBlurred"),onEnterKeyed=c(this,"isActive","isOpen","_onEnterKeyed"),onTabKeyed=c(this,"isActive","isOpen","_onTabKeyed"),onEscKeyed=c(this,"isActive","_onEscKeyed"),onUpKeyed=c(this,"isActive","open","_onUpKeyed"),onDownKeyed=c(this,"isActive","open","_onDownKeyed"),onLeftKeyed=c(this,"isActive","isOpen","_onLeftKeyed"),onRightKeyed=c(this,"isActive","isOpen","_onRightKeyed"),onQueryChanged=c(this,"_openIfActive","_onQueryChanged"),onWhitespaceChanged=c(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",onFocused,this).onSync("blurred",onBlurred,this).onSync("enterKeyed",onEnterKeyed,this).onSync("tabKeyed",onTabKeyed,this).onSync("escKeyed",onEscKeyed,this).onSync("upKeyed",onUpKeyed,this).onSync("downKeyed",onDownKeyed,this).onSync("leftKeyed",onLeftKeyed,this).onSync("rightKeyed",onRightKeyed,this).onSync("queryChanged",onQueryChanged,this).onSync("whitespaceChanged",onWhitespaceChanged,this).onSync("langDirChanged",this._onLangDirChanged,this)}function c(ctx){var methods=[].slice.call(arguments,1);return function(){var args=[].slice.call(arguments);_.each(methods,function(method){return ctx[method].apply(ctx,args)})}}return _.mixin(Typeahead.prototype,{_hacks:function(){var $input,$menu;$input=this.input.$input||$("<div>"),$menu=this.menu.$node||$("<div>"),$input.on("blur.tt",function($e){var active,isActive,hasActive;active=document.activeElement,isActive=$menu.is(active),hasActive=$menu.has(active).length>0,_.isMsie()&&(isActive||hasActive)&&($e.preventDefault(),$e.stopImmediatePropagation(),_.defer(function(){$input.focus()}))}),$menu.on("mousedown.tt",function($e){$e.preventDefault()})},_onSelectableClicked:function(type,$el){this.select($el)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(type,dataset,suggestions,async){this._updateHint(),this.eventBus.trigger("render",suggestions,async,dataset)},_onAsyncRequested:function(type,dataset,query){this.eventBus.trigger("asyncrequest",query,dataset)},_onAsyncCanceled:function(type,dataset,query){this.eventBus.trigger("asynccancel",query,dataset)},_onAsyncReceived:function(type,dataset,query){this.eventBus.trigger("asyncreceive",query,dataset)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(type,$e){var $selectable;($selectable=this.menu.getActiveSelectable())&&this.select($selectable)&&$e.preventDefault()},_onTabKeyed:function(type,$e){var $selectable;($selectable=this.menu.getActiveSelectable())?this.select($selectable)&&$e.preventDefault():($selectable=this.menu.getTopSelectable())&&this.autocomplete($selectable)&&$e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(e,query){this._minLengthMet(query)?this.menu.update(query):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(e,dir){this.dir!==dir&&(this.dir=dir,this.menu.setLanguageDirection(dir))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(query){return query=_.isString(query)?query:this.input.getQuery()||"",query.length>=this.minLength},_updateHint:function(){var $selectable,data,val,query,escapedQuery,frontMatchRegEx,match;$selectable=this.menu.getTopSelectable(),data=this.menu.getSelectableData($selectable),val=this.input.getInputValue(),!data||_.isBlankString(val)||this.input.hasOverflow()?this.input.clearHint():(query=Input.normalizeQuery(val),escapedQuery=_.escapeRegExChars(query),frontMatchRegEx=new RegExp("^(?:"+escapedQuery+")(.+$)","i"),match=frontMatchRegEx.exec(data.val),match&&this.input.setHint(val+match[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return this.isActive()?!0:!this.isEnabled()||this.eventBus.before("active")?!1:(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return this.isActive()?this.eventBus.before("idle")?!1:(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0):!0},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(val){this.input.setQuery(_.toStr(val))},getVal:function(){return this.input.getQuery()},select:function($selectable){var data=this.menu.getSelectableData($selectable);return data&&!this.eventBus.before("select",data.obj)?(this.input.setQuery(data.val,!0),this.eventBus.trigger("select",data.obj),this.close(),!0):!1},autocomplete:function($selectable){var query,data,isValid;return query=this.input.getQuery(),data=this.menu.getSelectableData($selectable),isValid=data&&query!==data.val,isValid&&!this.eventBus.before("autocomplete",data.obj)?(this.input.setQuery(data.val),this.eventBus.trigger("autocomplete",data.obj),!0):!1},moveCursor:function(delta){var query,$candidate,data,payload,cancelMove;return query=this.input.getQuery(),$candidate=this.menu.selectableRelativeToCursor(delta),data=this.menu.getSelectableData($candidate),payload=data?data.obj:null,cancelMove=this._minLengthMet()&&this.menu.update(query),cancelMove||this.eventBus.before("cursorchange",payload)?!1:(this.menu.setCursor($candidate),data?this.input.setInputValue(data.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",payload),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),Typeahead}();!function(){"use strict";function ttEach($els,fn){$els.each(function(){var typeahead,$input=$(this);(typeahead=$input.data(keys.typeahead))&&fn(typeahead,$input)})}function buildHintFromInput($input,www){return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function prepInput($input,www){$input.data(keys.attrs,{dir:$input.attr("dir"),autocomplete:$input.attr("autocomplete"),spellcheck:$input.attr("spellcheck"),style:$input.attr("style")}),$input.addClass(www.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!$input.attr("dir")&&$input.attr("dir","auto")}catch(e){}return $input}function getBackgroundStyles($el){return{backgroundAttachment:$el.css("background-attachment"),backgroundClip:$el.css("background-clip"),backgroundColor:$el.css("background-color"),backgroundImage:$el.css("background-image"),backgroundOrigin:$el.css("background-origin"),backgroundPosition:$el.css("background-position"),backgroundRepeat:$el.css("background-repeat"),backgroundSize:$el.css("background-size")}}function revert($input){var www,$wrapper;www=$input.data(keys.www),$wrapper=$input.parent().filter(www.selectors.wrapper),_.each($input.data(keys.attrs),function(val,key){_.isUndefined(val)?$input.removeAttr(key):$input.attr(key,val)}),$input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input),$wrapper.length&&($input.detach().insertAfter($wrapper),$wrapper.remove())}function $elOrNull(obj){var isValid,$el;return isValid=_.isJQuery(obj)||_.isElement(obj),$el=isValid?$(obj).first():[],$el.length?$el:null}var old,keys,methods;old=$.fn.typeahead,keys={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},methods={initialize:function(o,datasets){function attach(){var $input,$wrapper,$hint,$menu,defaultHint,defaultMenu,eventBus,input,menu,typeahead,MenuConstructor;_.each(datasets,function(d){d.highlight=!!o.highlight}),$input=$(this),$wrapper=$(www.html.wrapper),$hint=$elOrNull(o.hint),$menu=$elOrNull(o.menu),defaultHint=o.hint!==!1&&!$hint,defaultMenu=o.menu!==!1&&!$menu,defaultHint&&($hint=buildHintFromInput($input,www)),defaultMenu&&($menu=$(www.html.menu).css(www.css.menu)),$hint&&$hint.val(""),$input=prepInput($input,www),(defaultHint||defaultMenu)&&($wrapper.css(www.css.wrapper),$input.css(defaultHint?www.css.input:www.css.inputWithNoHint),$input.wrap($wrapper).parent().prepend(defaultHint?$hint:null).append(defaultMenu?$menu:null)),MenuConstructor=defaultMenu?DefaultMenu:Menu,eventBus=new EventBus({el:$input}),input=new Input({hint:$hint,input:$input},www),menu=new MenuConstructor({node:$menu,datasets:datasets},www),typeahead=new Typeahead({input:input,menu:menu,eventBus:eventBus,minLength:o.minLength},www),$input.data(keys.www,www),$input.data(keys.typeahead,typeahead)}var www;return datasets=_.isArray(datasets)?datasets:[].slice.call(arguments,1),o=o||{},www=WWW(o.classNames),this.each(attach)},isEnabled:function(){var enabled;return ttEach(this.first(),function(t){enabled=t.isEnabled()}),enabled},enable:function(){return ttEach(this,function(t){t.enable()}),this},disable:function(){return ttEach(this,function(t){t.disable()}),this},isActive:function(){var active;return ttEach(this.first(),function(t){active=t.isActive()}),active},activate:function(){return ttEach(this,function(t){t.activate()}),this},deactivate:function(){return ttEach(this,function(t){t.deactivate()}),this},isOpen:function(){var open;return ttEach(this.first(),function(t){open=t.isOpen()}),open},open:function(){return ttEach(this,function(t){t.open()}),this},close:function(){return ttEach(this,function(t){t.close()}),this},select:function(el){var success=!1,$el=$(el);return ttEach(this.first(),function(t){success=t.select($el)}),success},autocomplete:function(el){var success=!1,$el=$(el);return ttEach(this.first(),function(t){success=t.autocomplete($el)}),success},moveCursor:function(delta){var success=!1;return ttEach(this.first(),function(t){success=t.moveCursor(delta)}),success},val:function(newVal){var query;return arguments.length?(ttEach(this,function(t){t.setVal(newVal)}),this):(ttEach(this.first(),function(t){query=t.getVal()}),query)},destroy:function(){return ttEach(this,function(typeahead,$input){revert($input),typeahead.destroy()}),this}},$.fn.typeahead=function(method){return methods[method]?methods[method].apply(this,[].slice.call(arguments,1)):methods.initialize.apply(this,arguments)},$.fn.typeahead.noConflict=function(){return $.fn.typeahead=old,this}}()}),yii.gii=function($){var $clipboardContainer=$("#clipboard-container"),valueToCopy="",onKeydown=function(e){var $target;return $target=$(e.target),$target.is("input:visible, textarea:visible")||"function"==typeof window.getSelection&&window.getSelection().toString()||null!=document.selection&&document.selection.createRange().text?void 0:($clipboardContainer.empty().show(),$("<textarea id='clipboard'></textarea>").val(valueToCopy).appendTo($clipboardContainer).focus().select())},onKeyup=function(e){return $(e.target).is("#clipboard")&&$("#clipboard-container").empty().hide(),!0},initHintBlocks=function(){$(".hint-block").each(function(){var $hint=$(this);$hint.parent().find("label").addClass("help").popover({html:!0,trigger:"hover",placement:"right",content:$hint.html()})})},initStickyInputs=function(){$(".sticky:not(.error)").find('input[type="text"],select,textarea').each(function(){var value;value="SELECT"===this.tagName?this.options[this.selectedIndex].text:"TEXTAREA"===this.tagName?$(this).html():$(this).val(),""===value&&(value="[empty]"),$(this).before('<div class="sticky-value">'+value+"</div>").hide()}),$(".sticky-value").on("click",function(){$(this).hide(),$(this).next().show().get(0).focus()})},fillModal=function(data){var $modal=$("#preview-modal"),$link=$(this),$modalBody=$modal.find(".modal-body");if(!$link.hasClass("modal-refresh")){var filesSelector="a."+$modal.data("action"),$files=$(filesSelector),index=$files.filter('[href="'+$link.attr("href")+'"]').index(filesSelector),$prev=$files.eq(index-1),$next=$files.eq(index+1==$files.length?0:index+1);$modal.data("current",$files.eq(index)),$modal.find(".modal-previous").attr("href",$prev.attr("href")).data("title",$prev.data("title")),$modal.find(".modal-next").attr("href",$next.attr("href")).data("title",$next.data("title"))}$modalBody.html(data),valueToCopy=$("<div/>").html(data.replace(/(<(br[^>]*)>)/gi,"\n")).text().trim()+"\n",$modal.find(".content").css("max-height",$(window).height()-200+"px")},initPreviewDiffLinks=function(){$(".preview-code, .diff-code, .modal-refresh, .modal-previous, .modal-next").on("click",function(){var $modal=$("#preview-modal"),$link=$(this);$modal.find(".modal-refresh").attr("href",$link.attr("href")),($link.hasClass("preview-code")||$link.hasClass("diff-code"))&&$modal.data("action",$link.hasClass("preview-code")?"preview-code":"diff-code"),$modal.find(".modal-title").text($link.data("title")),$modal.find(".modal-body").html("Loading ..."),$modal.modal("show");var checkbox=$("a."+$modal.data("action")+'[href="'+$link.attr("href")+'"]').closest("tr").find("input").get(0),checked=!1;return checkbox?(checked=checkbox.checked,$modal.find(".modal-checkbox").removeClass("disabled")):$modal.find(".modal-checkbox").addClass("disabled"),$modal.find(".modal-checkbox span").toggleClass("glyphicon-check",checked).toggleClass("glyphicon-unchecked",!checked),$.ajax({type:"POST",cache:!1,url:$link.prop("href"),data:$(".default-view form").serializeArray(),success:function(data){fillModal(data)},error:function(XMLHttpRequest,textStatus,errorThrown){$modal.find(".modal-body").html('<div class="error">'+XMLHttpRequest.responseText+"</div>")}}),!1}),$("#preview-modal").on("keydown",function(e){37===e.keyCode?$(".modal-previous").trigger("click"):39===e.keyCode?$(".modal-next").trigger("click"):82===e.keyCode?$(".modal-refresh").trigger("click"):32===e.keyCode&&$(".modal-checkbox").trigger("click")}),$(".modal-checkbox").on("click",checkFileToggle)},checkFileToggle=function(){var $modal=$("#preview-modal"),$checkbox=$modal.data("current").closest("tr").find("input"),checked=!$checkbox.prop("checked");return $checkbox.prop("checked",checked),$modal.find(".modal-checkbox span").toggleClass("glyphicon-check",checked).toggleClass("glyphicon-unchecked",!checked),!1},checkAllToggle=function(){$("#check-all").prop("checked",!$(".default-view-files table .check input:enabled:not(:checked)").length)},initConfirmationCheckboxes=function(){var $checkAll=$("#check-all");$checkAll.click(function(){$(".default-view-files table .check input:enabled").prop("checked",this.checked)}),$(".default-view-files table .check input").click(function(){checkAllToggle()}),checkAllToggle()},initToggleActions=function(){$("#action-toggle :input").change(function(){$(this).parent("label").toggleClass("active",this.checked),$("."+this.value,".default-view-files table").toggle(this.checked).find(".check input").attr("disabled",!this.checked),checkAllToggle()})};return $(document).on("keydown",function(e){return valueToCopy&&(e.ctrlKey||e.metaKey)&&67===e.which?onKeydown(e):void 0}).on("keyup",onKeyup),{autocomplete:function(counter,data){var datum=new Bloodhound({datumTokenizer:function(d){return Bloodhound.tokenizers.whitespace(d.word)},queryTokenizer:Bloodhound.tokenizers.whitespace,local:data});datum.initialize(),jQuery(".typeahead-"+counter).typeahead(null,{displayKey:"word",source:datum.ttAdapter()})},init:function(){initHintBlocks(),initStickyInputs(),initPreviewDiffLinks(),initConfirmationCheckboxes(),initToggleActions(),$("#model-generator #generator-tablename").change(function(){var show=-1===$(this).val().indexOf("*");$(".field-generator-modelclass").toggle(show),$("#generator-generatequery").is(":checked")&&$(".field-generator-queryclass").toggle(show)}).change(),$("#model-generator #generator-tablename").on("blur",function(){var tableName=$(this).val();if(""===$("#generator-modelclass").val()&&tableName&&-1===tableName.indexOf("*")){var modelClass="";$.each(tableName.split("_"),function(){this.length>0&&(modelClass+=this.substring(0,1).toUpperCase()+this.substring(1))}),$("#generator-modelclass").val(modelClass).blur()}}),$("#model-generator #generator-modelclass").on("blur",function(){var modelClass=$(this).val();if(""!==modelClass){var queryClass=$("#generator-queryclass").val();""===queryClass&&(queryClass=modelClass+"Query",$("#generator-queryclass").val(queryClass))}}),$("#model-generator #generator-ns").on("blur",function(){var stickyValue=$("#model-generator .field-generator-queryns .sticky-value"),input=$("#model-generator #generator-queryns");if(stickyValue.is(":visible")||!input.is(":visible")){var ns=$(this).val();stickyValue.html(ns),input.val(ns)}}),$("form #generator-generatequery").change(function(){$("form .field-generator-queryns").toggle($(this).is(":checked")),$("form .field-generator-queryclass").toggle($(this).is(":checked")),$("form .field-generator-querybaseclass").toggle($(this).is(":checked"))}).change(),$("form #generator-enablei18n").change(function(){$("form .field-generator-messagecategory").toggle($(this).is(":checked"))}).change(),$(".default-view .form-group input,select,textarea").change(function(){$(".default-view-results,.default-view-files").hide(),$('.default-view button[name="generate"]').hide()}),$(".module-form #generator-moduleclass").change(function(){var value=$(this).val().match(/(\w+)\\\w+$/),$idInput=$("#generator-moduleid");value&&value[1]&&""===$idInput.val()&&$idInput.val(value[1])})}}}(jQuery),function($){var KvFormBuilder=function(element,options){this.$element=$(element),this.init()};KvFormBuilder.prototype={constructor:KvFormBuilder,init:function(){var self=this,$form=self.$element.closest("form");self.$target=self.$element.find(".kv-nested-attribute-block"),$form.on("reset.yiiActiveForm",function(){setTimeout(function(){self.$target.removeClass("has-success has-error")},100)}),$form.on("afterValidateAttribute",function(event,attribute,messages){self.validate(attribute,messages)})},validate:function(attribute,messages){var self=this;0!=self.$target.length&&self.$target.each(function(){var hasError=!1,hasSuccess=!1,$el=$(this);$el.find("input").each(function(){var id=$(this).attr("id");id==attribute.id&&(messages.length>0?(hasError=!0,hasSuccess=!1):hasError!==!1||attribute.cancelled||2!==attribute.status&&3!==attribute.status||(hasSuccess=!0));
}),hasError?$el.removeClass("has-success has-error").addClass("has-error"):hasSuccess&&$el.removeClass("has-success has-error").addClass("has-success")})}},$.fn.kvFormBuilder=function(option){var args=Array.apply(null,arguments);return args.shift(),this.each(function(){var $this=$(this),data=$this.data("kvFormBuilder"),options="object"==typeof option&&option;data||$this.data("kvFormBuilder",data=new KvFormBuilder(this,$.extend({},$.fn.kvFormBuilder.defaults,options,$(this).data()))),"string"==typeof option&&data[option].apply(data,args)})}}(jQuery),function($){"use strict";var replaceAll=function(str,from,to){return str.split(from).join(to)},isEmpty=function(value,trim){return null===value||void 0===value||0===value.length||trim&&""===$.trim(value)},popupDialog=function(url,name,w,h){var left=screen.width/2-w/2,top=60,existWin=window.open("",name,"",!0);return existWin.close(),window.open(url,name,"toolbar=no, location=no, directories=no, status=yes, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+w+", height="+h+", top="+top+", left="+left)},slug=function(strText){return strText.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},templates={html:'<!DOCTYPE html><meta http-equiv="Content-Type" content="text/html;charset={encoding}"/><meta http-equiv="X-UA-Compatible" content="IE=edge;chrome=1"/>{css}<style>.kv-wrap{padding:20px;}.kv-align-center{text-align:center;}.kv-align-left{text-align:left;}.kv-align-right{text-align:right;}.kv-align-top{vertical-align:top!important;}.kv-align-bottom{vertical-align:bottom!important;}.kv-align-middle{vertical-align:middle!important;}.kv-page-summary{border-top:4px double #ddd;font-weight: bold;}.kv-table-footer{border-top:4px double #ddd;font-weight: bold;}.kv-table-caption{font-size:1.5em;padding:8px;border:1px solid #ddd;border-bottom:none;}</style><body class="kv-wrap">{data}</body>',pdf:"{before}\n{data}\n{after}",excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel"xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html;charset={encoding}"/>{css}<!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>{data}</body></html>',popup:'<html style="display:table;width:100%;height:100%;"><title>Grid Export - &copy; Krajee</title><body style="display:table-cell;font-family:Helvetica,Arial,sans-serif;color:#888;font-weight:bold;line-height:1.4em;text-align:center;vertical-align:middle;width:100%;height:100%;padding:0 10px;">{msg}</body></html>'},GridExport=function(element,options){this.$element=$(element);var gridOpts=options.gridOpts,genOpts=options.genOpts;this.$grid=$("#"+gridOpts.gridId),this.messages=gridOpts.messages,this.target=gridOpts.target,this.exportConversions=gridOpts.exportConversions,this.showConfirmAlert=gridOpts.showConfirmAlert,this.filename=genOpts.filename,this.showHeader=genOpts.showHeader,this.showFooter=genOpts.showFooter,this.showPageSummary=genOpts.showPageSummary,this.$table=this.$grid.find(".kv-grid-table:first"),this.$form=this.$grid.find("form.kv-export-form"),this.encoding=this.$form.find('[name="export_encoding"]').val(),this.columns=this.showHeader?"td,th":"td",this.alertMsg=options.alertMsg,this.config=options.config,this.popup="",this.listen()};GridExport.prototype={constructor:GridExport,getArray:function(expType){var self=this,$table=self.clean(expType),head=[],data={};return void 0!==self.config.colHeads&&self.config.colHeads.length>0?head=self.config.colHeads:$table.find("thead tr th").each(function(i,v){var str=$(this).text().trim(),slugStr=slug(str);head[i]=!self.config.slugColHeads||isEmpty(slugStr)?"col_"+i:slugStr}),$table.find('tbody tr:has("td")').each(function(i,v){data[i]={},$(this).children("td").each(function(j,w){var col=head[j];data[i][col]=$(this).text().trim()})}),data},notify:function(e){var self=this;if(!self.showConfirmAlert)return e.preventDefault(),!0;var msgs=self.messages,msg1=isEmpty(self.alertMsg)?"":self.alertMsg,msg2=isEmpty(msgs.allowPopups)?"":msgs.allowPopups,msg3=isEmpty(msgs.confirmDownload)?"":msgs.confirmDownload,msg="";return msg=msg1.length&&msg2.length?msg1+"\n\n"+msg2:!msg1.length&&msg2.length?msg2:msg1.length&&!msg2.length?msg1:"",msg3.length&&(msg=msg+"\n\n"+msg3),e.preventDefault(),isEmpty(msg)?!0:self.kvConfirm(msg)},kvConfirm:function(msg){try{return window.confirm(msg)}catch(err){return!0}},setPopupAlert:function(msg){var self=this;if(void 0!==self.popup.document)if(arguments.length&&arguments[1]){var el=self.popup.document.getElementsByTagName("body");setTimeout(function(){el[0].innerHTML=msg},4e3)}else{var newmsg=templates.popup.replace("{msg}",msg);self.popup.document.write(newmsg)}},listenClick:function(callback){var self=this,arg=arguments.length>1?arguments[1]:"";self.$element.on("click",function(e){self.notify(e)&&(isEmpty(arg)?self[callback]():self[callback](arg),e.preventDefault())})},listen:function(){var self=this;"_popup"===self.target&&self.$form.on("submit",function(){setTimeout(function(){self.setPopupAlert(self.messages.downloadComplete,!0)},1e3)}),self.$element.hasClass("export-csv")&&self.listenClick("exportTEXT","csv"),self.$element.hasClass("export-txt")&&self.listenClick("exportTEXT","txt"),self.$element.hasClass("export-html")&&self.listenClick("exportHTML"),self.$element.hasClass("export-xls")&&self.listenClick("exportEXCEL"),self.$element.hasClass("export-json")&&self.listenClick("exportJSON"),self.$element.hasClass("export-pdf")&&self.listenClick("exportPDF")},clean:function(expType){var self=this,$table=self.$table.clone();$table.find("tr.filters").remove(),$table.find("th").removeAttr("rowspan"),$table.find("th").find("a").each(function(){$(this).contents().unwrap()}),$table.find("input").remove(),self.showHeader||$table.find("thead").remove(),self.showPageSummary||$table.find("tfoot.kv-page-summary").remove(),self.showFooter||$table.find("tfoot.kv-table-footer").remove(),self.showCaption||$table.find("kv-table-caption").remove(),$table.find(".skip-export").remove(),$table.find(".skip-export-"+expType).remove();var htmlContent=$table.html();return htmlContent=self.preProcess(htmlContent),$table.html(htmlContent),$table},preProcess:function(content){var c,self=this,conv=self.exportConversions,l=conv.length,processed=content;if(l>0)for(var i=0;l>i;i++)c=conv[i],processed=replaceAll(processed,c.from,c.to);return processed},download:function(type,content){var self=this,fmt=self.$element.data("format"),config=isEmpty(self.config)?{}:self.config;self.$form.find('[name="export_filetype"]').val(type),self.$form.find('[name="export_filename"]').val(self.filename),self.$form.find('[name="export_content"]').val(content),self.$form.find('[name="export_mime"]').val(fmt),"pdf"===type?self.$form.find('[name="export_config"]').val(JSON.stringify(config)):self.$form.find('[name="export_config"]').val(""),"_popup"===self.target&&(self.popup=popupDialog("","kvDownloadDialog",350,120),self.popup.focus(),self.setPopupAlert(self.messages.downloadProgress)),self.$form.submit()},exportHTML:function(){var self=this,$table=self.clean("html"),cfg=self.config,css=self.config.cssFile&&cfg.cssFile.length?'<link href="'+self.config.cssFile+'" rel="stylesheet">':"",html=templates.html.replace("{encoding}",self.encoding).replace("{css}",css).replace("{data}",$("<div />").html($table).html());self.download("html",html)},exportPDF:function(){var self=this,$table=self.clean("pdf"),before=isEmpty(self.config.contentBefore)?"":self.config.contentBefore,after=isEmpty(self.config.contentAfter)?"":self.config.contentAfter,css=self.config.css,pdf=templates.pdf.replace("{css}",css).replace("{before}",before).replace("{after}",after).replace("{data}",$("<div />").html($table).html());self.download("pdf",pdf)},exportTEXT:function(expType){var self=this,$table=self.clean(expType),$rows=$table.find("tr:has("+self.columns+")"),tmpColDelim=String.fromCharCode(11),tmpRowDelim=String.fromCharCode(0),colDelim='"'+self.config.colDelimiter+'"',rowDelim='"'+self.config.rowDelimiter+'"',txt='"'+$rows.map(function(i,row){var $row=$(row),$cols=$row.find(self.columns);return $cols.map(function(j,col){var $col=$(col),text=$col.text().trim();return text.replace('"','""')}).get().join(tmpColDelim)}).get().join(tmpRowDelim).split(tmpRowDelim).join(rowDelim).split(tmpColDelim).join(colDelim)+'"';self.download(expType,txt)},exportJSON:function(){var self=this,out=self.getArray("json");out=JSON.stringify(out,self.config.jsonReplacer,self.config.indentSpace),self.download("json",out)},exportEXCEL:function(){var xls,$td,self=this,$table=self.clean("xls"),cfg=self.config,css=cfg.cssFile&&self.config.cssFile.length?'<link href="'+self.config.cssFile+'" rel="stylesheet">':"";$table.find("td[data-raw-value]").each(function(){$td=$(this),($td.css("mso-number-format")||0===$td.css("mso-number-format")||"0"===$td.css("mso-number-format"))&&$td.html($td.attr("data-raw-value")).removeAttr("data-raw-value")}),xls=templates.excel.replace("{encoding}",self.encoding).replace("{css}",css).replace("{worksheet}",self.config.worksheet).replace("{data}",$("<div />").html($table).html()).replace(/"/g,"'"),self.download("xls",xls)}},$.fn.gridexport=function(option){var args=Array.apply(null,arguments);return args.shift(),this.each(function(){var $this=$(this),data=$this.data("gridexport"),options="object"==typeof option&&option;data||$this.data("gridexport",data=new GridExport(this,$.extend({},$.fn.gridexport.defaults,options,$(this).data()))),"string"==typeof option&&data[option].apply(data,args)})},$.fn.gridexport.defaults={},$.fn.gridexport.Constructor=GridExport}(window.jQuery);var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__slice=[].slice;!function($,window){var ResizableColumns,parseWidth,pointerX,setWidth;return parseWidth=function(node){return parseFloat(node.style.width.replace("%",""))},setWidth=function(node,width){return width=width.toFixed(2),width=width>0?width:0,node.style.width=""+width+"%"},pointerX=function(e){return 0===e.type.indexOf("touch")?(e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]).pageX:e.pageX},ResizableColumns=function(){function ResizableColumns($table,options){this.pointerdown=__bind(this.pointerdown,this),this.constrainWidth=__bind(this.constrainWidth,this),this.options=$.extend({},this.defaults,options),this.$table=$table,this.setHeaders(),this.restoreColumnWidths(),this.syncHandleWidths(),$(window).on("resize.rc",function(_this){return function(){return _this.syncHandleWidths()}}(this)),this.options.start&&this.$table.bind("column:resize:start.rc",this.options.start),this.options.resize&&this.$table.bind("column:resize.rc",this.options.resize),this.options.stop&&this.$table.bind("column:resize:stop.rc",this.options.stop)}return ResizableColumns.prototype.defaults={selector:"tr th:visible",store:window.store,syncHandlers:!0,resizeFromBody:!0,maxWidth:null,minWidth:null},ResizableColumns.prototype.triggerEvent=function(type,args,original){var event;return event=$.Event(type),event.originalEvent=$.extend({},original),this.$table.trigger(event,[this].concat(args||[]))},ResizableColumns.prototype.getColumnId=function($el){return this.$table.data("resizable-columns-id")+"-"+$el.data("resizable-column-id")},ResizableColumns.prototype.setHeaders=function(){return this.$tableHeaders=this.$table.find(this.options.selector),this.assignPercentageWidths(),this.createHandles()},ResizableColumns.prototype.destroy=function(){return this.$handleContainer.remove(),this.$table.removeData("resizableColumns"),this.$table.add(window).off(".rc")},ResizableColumns.prototype.assignPercentageWidths=function(){return this.$tableHeaders.each(function(_this){return function(_,el){var $el;return $el=$(el),setWidth($el[0],$el.outerWidth()/_this.$table.width()*100)}}(this))},ResizableColumns.prototype.createHandles=function(){var _ref;return null!=(_ref=this.$handleContainer)&&_ref.remove(),this.$table.before(this.$handleContainer=$("<div class='rc-handle-container' />")),this.$tableHeaders.each(function(_this){return function(i,el){var $handle;if(0!==_this.$tableHeaders.eq(i+1).length&&null==_this.$tableHeaders.eq(i).attr("data-noresize")&&null==_this.$tableHeaders.eq(i+1).attr("data-noresize"))return $handle=$("<div class='rc-handle' />"),$handle.data("th",$(el)),$handle.appendTo(_this.$handleContainer)}}(this)),this.$handleContainer.on("mousedown touchstart",".rc-handle",this.pointerdown)},ResizableColumns.prototype.syncHandleWidths=function(){return this.$handleContainer.width(this.$table.width()).find(".rc-handle").each(function(_this){return function(_,el){var $el;return $el=$(el),$el.css({left:$el.data("th").outerWidth()+($el.data("th").offset().left-_this.$handleContainer.offset().left),height:_this.options.resizeFromBody?_this.$table.height():_this.$table.find("thead").height()})}}(this))},ResizableColumns.prototype.saveColumnWidths=function(){return this.$tableHeaders.each(function(_this){return function(_,el){var $el;return $el=$(el),null==$el.attr("data-noresize")&&null!=_this.options.store?_this.options.store.set(_this.getColumnId($el),parseWidth($el[0])):void 0}}(this))},ResizableColumns.prototype.restoreColumnWidths=function(){return this.$tableHeaders.each(function(_this){return function(_,el){var $el,width;return $el=$(el),null!=_this.options.store&&(width=_this.options.store.get(_this.getColumnId($el)))?setWidth($el[0],width):void 0}}(this))},ResizableColumns.prototype.totalColumnWidths=function(){var total;return total=0,this.$tableHeaders.each(function(_this){return function(_,el){return total+=parseFloat($(el)[0].style.width.replace("%",""))}}(this)),total},ResizableColumns.prototype.constrainWidth=function(width){return null!=this.options.minWidth&&(width=Math.max(this.options.minWidth,width)),null!=this.options.maxWidth&&(width=Math.min(this.options.maxWidth,width)),width},ResizableColumns.prototype.pointerdown=function(e){var $currentGrip,$leftColumn,$ownerDocument,$rightColumn,newWidths,startPosition,widths;return e.preventDefault(),$ownerDocument=$(e.currentTarget.ownerDocument),startPosition=pointerX(e),$currentGrip=$(e.currentTarget),$leftColumn=$currentGrip.data("th"),$rightColumn=this.$tableHeaders.eq(this.$tableHeaders.index($leftColumn)+1),widths={left:parseWidth($leftColumn[0]),right:parseWidth($rightColumn[0])},newWidths={left:widths.left,right:widths.right},this.$handleContainer.add(this.$table).addClass("rc-table-resizing"),$leftColumn.add($rightColumn).add($currentGrip).addClass("rc-column-resizing"),this.triggerEvent("column:resize:start",[$leftColumn,$rightColumn,newWidths.left,newWidths.right],e),$ownerDocument.on("mousemove.rc touchmove.rc",function(_this){return function(e){var difference;return difference=(pointerX(e)-startPosition)/_this.$table.width()*100,setWidth($leftColumn[0],newWidths.left=_this.constrainWidth(widths.left+difference)),setWidth($rightColumn[0],newWidths.right=_this.constrainWidth(widths.right-difference)),null!=_this.options.syncHandlers&&_this.syncHandleWidths(),_this.triggerEvent("column:resize",[$leftColumn,$rightColumn,newWidths.left,newWidths.right],e)}}(this)),$ownerDocument.one("mouseup touchend",function(_this){return function(){return $ownerDocument.off("mousemove.rc touchmove.rc"),_this.$handleContainer.add(_this.$table).removeClass("rc-table-resizing"),$leftColumn.add($rightColumn).add($currentGrip).removeClass("rc-column-resizing"),_this.syncHandleWidths(),_this.saveColumnWidths(),_this.triggerEvent("column:resize:stop",[$leftColumn,$rightColumn,newWidths.left,newWidths.right],e)}}(this))},ResizableColumns}(),$.fn.extend({resizableColumns:function(){var args,option;return option=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],this.each(function(){var $table,data;return $table=$(this),data=$table.data("resizableColumns"),data||$table.data("resizableColumns",data=new ResizableColumns($table,option)),"string"==typeof option?data[option].apply(data,args):void 0})}})}(window.jQuery,window),function($){function windowResize(debounceMs,eventName,cb){if(8==ieVersion){var winWidth=$window.width(),debouncedCb=util.debounce(function(){var winWidthNew=$window.width();winWidth!=winWidthNew&&(winWidth=winWidthNew,cb())},debounceMs);$window.on(eventName,debouncedCb)}else $window.on(eventName,util.debounce(cb,debounceMs))}function debug(str){window.console&&window.console&&window.console.log&&window.console.log(str)}function scrollbarWidth(){var $div=$('<div style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"></div>');$("body").append($div);var w1=$div.innerWidth(),w2=$("div",$div).innerWidth();return $div.remove(),w1-w2}function isDatatable($table){if($table.dataTableSettings)for(var i=0;i<$table.dataTableSettings.length;i++){var table=$table.dataTableSettings[i].nTable;if($table[0]==table)return!0}return!1}$.floatThead=$.floatThead||{},$.floatThead.defaults={cellTag:null,headerCellSelector:"tr:first>th:visible",zIndex:1001,debounceResizeMs:10,useAbsolutePositioning:!0,scrollingTop:0,scrollingBottom:0,scrollContainer:function($table){return $([])},getSizingRow:function($table,$cols,$fthCells){return $table.find("tbody tr:visible:first>*:visible")},floatTableClass:"floatThead-table",floatWrapperClass:"floatThead-wrapper",floatContainerClass:"floatThead-container",copyTableClass:!0,debug:!1};var util=window._,ieVersion=function(){for(var a=3,b=document.createElement("b"),c=b.all||[];a=1+a,b.innerHTML="<!--[if gt IE "+a+"]><i><![endif]-->",c[0];);return a>4?a:document.documentMode}(),isChrome=null,isChromeCheck=function(){if(ieVersion)return!1;var $table=$("<table><colgroup><col></colgroup><tbody><tr><td style='width:10px'></td></tbody></table>");$("body").append($table);var width=$table.find("col").width();return $table.remove(),0==width},$window=$(window);$.fn.floatThead=function(map){if(map=map||{},!util&&(util=window._||$.floatThead._,!util))throw new Error("jquery.floatThead-slim.js requires underscore. You should use the non-lite version since you do not have underscore.");if(8>ieVersion)return this;if(null==isChrome&&(isChrome=isChromeCheck(),isChrome&&(document.createElement("fthtr"),document.createElement("fthtd"),document.createElement("fthfoot"))),util.isString(map)){var command=map,ret=this;return this.filter("table").each(function(){var obj=$(this).data("floatThead-attached");if(obj&&util.isFunction(obj[command])){var r=obj[command]();"undefined"!=typeof r&&(ret=r)}}),ret}var opts=$.extend({},$.floatThead.defaults||{},map);return $.each(map,function(key,val){key in $.floatThead.defaults||!opts.debug||debug("jQuery.floatThead: used ["+key+"] key to init plugin, but that param is not an option for the plugin. Valid options are: "+util.keys($.floatThead.defaults).join(", "))}),this.filter(":not(."+opts.floatTableClass+")").each(function(){function eventName(name){return name+".fth-"+floatTheadId+".floatTHead"}function setHeaderHeight(){var headerHeight=0;$header.find("tr:visible").each(function(){headerHeight+=$(this).outerHeight(!0)}),$sizerRow.outerHeight(headerHeight),$sizerCells.outerHeight(headerHeight)}function setFloatWidth(){var tableWidth=$table.outerWidth(),width=$scrollContainer.width()||tableWidth,floatContainerWidth="hidden"!=$scrollContainer.css("overflow-y")?width-scrollbarOffset.vertical:width;if($floatContainer.width(floatContainerWidth),locked){var percent=100*tableWidth/floatContainerWidth;$floatTable.css("width",percent+"%")}else $floatTable.outerWidth(tableWidth)}function updateScrollingOffsets(){scrollingTop=(util.isFunction(opts.scrollingTop)?opts.scrollingTop($table):opts.scrollingTop)||0,scrollingBottom=(util.isFunction(opts.scrollingBottom)?opts.scrollingBottom($table):opts.scrollingBottom)||0}function columnNum(){var count,$headerColumns;if(existingColGroup)count=$tableColGroup.find("col").length;else{var selector;if(selector=null==opts.cellTag&&opts.headerCellSelector?opts.headerCellSelector:"tr:first>"+opts.cellTag,util.isNumber(selector))return selector;$headerColumns=$header.find(selector),count=0,$headerColumns.each(function(){count+=parseInt($(this).attr("colspan")||1,10)})}if(count!=lastColumnCount){lastColumnCount=count;for(var cells=[],cols=[],psuedo=[],x=0;count>x;x++)cells.push('<th class="floatThead-col"/>'),cols.push("<col/>"),psuedo.push("<fthtd style='display:table-cell;height:0;width:auto;'/>");cols=cols.join(""),cells=cells.join(""),isChrome&&(psuedo=psuedo.join(""),$fthRow.html(psuedo),$fthCells=$fthRow.find("fthtd")),$sizerRow.html(cells),$sizerCells=$sizerRow.find("th"),existingColGroup||$tableColGroup.html(cols),$tableCells=$tableColGroup.find("col"),$floatColGroup.html(cols),$headerCells=$floatColGroup.find("col")}return count}function refloat(){if(!headerFloated){if(headerFloated=!0,useAbsolutePositioning){var tableWidth=$table.width(),wrapperWidth=$wrapper.width();tableWidth>wrapperWidth&&$table.css("minWidth",tableWidth)}$table.css(layoutFixed),$floatTable.css(layoutFixed),$floatTable.append($header),$tbody.before($newHeader),setHeaderHeight()}}function unfloat(){headerFloated&&(headerFloated=!1,useAbsolutePositioning&&$table.width(originalTableWidth),$newHeader.detach(),$table.prepend($header),$table.css(layoutAuto),$floatTable.css(layoutAuto),$table.css("minWidth",originalTableMinWidth),$table.css("minWidth",$table.width()))}function changePositioning(isAbsolute){useAbsolutePositioning!=isAbsolute&&(useAbsolutePositioning=isAbsolute,$floatContainer.css({position:useAbsolutePositioning?"absolute":"fixed"}))}function getSizingRow($table,$cols,$fthCells,ieVersion){return isChrome?$fthCells:ieVersion?opts.getSizingRow($table,$cols,$fthCells):$cols}function reflow(){var i,numCols=columnNum();return function(){var $rowCells=getSizingRow($table,$tableCells,$fthCells,ieVersion);if($rowCells.length==numCols&&numCols>0){if(!existingColGroup)for(i=0;numCols>i;i++)$tableCells.eq(i).css("width","");unfloat();var widths=[];for(i=0;numCols>i;i++)widths[i]=$rowCells.get(i).offsetWidth;for(i=0;numCols>i;i++)$headerCells.eq(i).width(widths[i]),$tableCells.eq(i).width(widths[i]);refloat()}else $floatTable.append($header),$table.css(layoutAuto),$floatTable.css(layoutAuto),setHeaderHeight()}}function floatContainerBorderWidth(side){var border=$scrollContainer.css("border-"+side+"-width"),w=0;return border&&~border.indexOf("px")&&(w=parseInt(border,10)),w}function calculateFloatContainerPosFn(){var floatEnd,scrollingContainerTop=$scrollContainer.scrollTop(),tableContainerGap=0,captionHeight=haveCaption?$caption.outerHeight(!0):0,captionScrollOffset=captionAlignTop?captionHeight:-captionHeight,floatContainerHeight=$floatContainer.height(),tableOffset=$table.offset(),tableLeftGap=0;if(locked){var containerOffset=$scrollContainer.offset();tableContainerGap=tableOffset.top-containerOffset.top+scrollingContainerTop,haveCaption&&captionAlignTop&&(tableContainerGap+=captionHeight),tableContainerGap-=floatContainerBorderWidth("top"),tableLeftGap=floatContainerBorderWidth("left")}else floatEnd=tableOffset.top-scrollingTop-floatContainerHeight+scrollingBottom+scrollbarOffset.horizontal;var windowTop=$window.scrollTop(),windowLeft=$window.scrollLeft(),scrollContainerLeft=$scrollContainer.scrollLeft();return scrollingContainerTop=$scrollContainer.scrollTop(),function(eventType){var isTableHidden=$table[0].offsetWidth<=0&&$table[0].offsetHeight<=0;if(!isTableHidden&&floatTableHidden)return floatTableHidden=!1,setTimeout(function(){$table.trigger("reflow")},1),null;if(isTableHidden&&(floatTableHidden=!0,!useAbsolutePositioning))return null;if("windowScroll"==eventType?(windowTop=$window.scrollTop(),windowLeft=$window.scrollLeft()):"containerScroll"==eventType?(scrollingContainerTop=$scrollContainer.scrollTop(),scrollContainerLeft=$scrollContainer.scrollLeft()):"init"!=eventType&&(windowTop=$window.scrollTop(),windowLeft=$window.scrollLeft(),scrollingContainerTop=$scrollContainer.scrollTop(),scrollContainerLeft=$scrollContainer.scrollLeft()),!isChrome||!(0>windowTop||0>windowLeft)){if(absoluteToFixedOnScroll)changePositioning("windowScrollDone"==eventType?!0:!1);else if("windowScrollDone"==eventType)return null;tableOffset=$table.offset(),haveCaption&&captionAlignTop&&(tableOffset.top+=captionHeight);var top,left,tableHeight=$table.outerHeight();if(locked&&useAbsolutePositioning){if(tableContainerGap>=scrollingContainerTop){var gap=tableContainerGap-scrollingContainerTop;top=gap>0?gap:0}else top=wrappedContainer?0:scrollingContainerTop;left=tableLeftGap}else!locked&&useAbsolutePositioning?(windowTop>floatEnd+tableHeight+captionScrollOffset?top=tableHeight-floatContainerHeight+captionScrollOffset:tableOffset.top>windowTop+scrollingTop?(top=0,unfloat()):(top=scrollingTop+windowTop-tableOffset.top+tableContainerGap+(captionAlignTop?captionHeight:0),refloat()),left=0):locked&&!useAbsolutePositioning?(tableContainerGap>scrollingContainerTop||scrollingContainerTop-tableContainerGap>tableHeight?(top=tableOffset.top-windowTop,unfloat()):(top=tableOffset.top+scrollingContainerTop-windowTop-tableContainerGap,refloat()),left=tableOffset.left+scrollContainerLeft-windowLeft):locked||useAbsolutePositioning||(windowTop>floatEnd+tableHeight+captionScrollOffset?top=tableHeight+scrollingTop-windowTop+floatEnd+captionScrollOffset:tableOffset.top>windowTop+scrollingTop?(top=tableOffset.top-windowTop,refloat()):top=scrollingTop,left=tableOffset.left-windowLeft);return{top:top,left:left}}}}function repositionFloatContainerFn(){var oldTop=null,oldLeft=null,oldScrollLeft=null;return function(pos,setWidth,setHeight){null==pos||oldTop==pos.top&&oldLeft==pos.left||($floatContainer.css({top:pos.top,left:pos.left}),oldTop=pos.top,oldLeft=pos.left),setWidth&&setFloatWidth(),setHeight&&setHeaderHeight();var scrollLeft=$scrollContainer.scrollLeft();useAbsolutePositioning&&oldScrollLeft==scrollLeft||($floatContainer.scrollLeft(scrollLeft),oldScrollLeft=scrollLeft)}}function calculateScrollBarSize(){if($scrollContainer.length){var sw=$scrollContainer.width(),sh=$scrollContainer.height(),th=$table.height(),tw=$table.width(),offseth=tw>sw?scWidth:0,offsetv=th>sh?scWidth:0;scrollbarOffset.horizontal=tw>sw-offsetv?scWidth:0,scrollbarOffset.vertical=th>sh-offseth?scWidth:0}}var floatTheadId=util.uniqueId(),$table=$(this);if($table.data("floatThead-attached"))return!0;if(!$table.is("table"))throw new Error('jQuery.floatThead must be run on a table element. ex: $("table").floatThead();');var $header=$table.find("thead:first"),$tbody=$table.find("tbody:first");if(0==$header.length)throw new Error("jQuery.floatThead must be run on a table that contains a <thead> element");var scrollingTop,scrollingBottom,headerFloated=!1,scrollbarOffset={vertical:0,horizontal:0},scWidth=scrollbarWidth(),lastColumnCount=0,$scrollContainer=opts.scrollContainer($table)||$([]),useAbsolutePositioning=opts.useAbsolutePositioning;null==useAbsolutePositioning&&(useAbsolutePositioning=opts.scrollContainer($table).length),useAbsolutePositioning||(headerFloated=!0);var $caption=$table.find("caption"),haveCaption=1==$caption.length;if(haveCaption)var captionAlignTop="top"===($caption.css("caption-side")||$caption.attr("align")||"top");var $fthGrp=$('<fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"/>'),locked=$scrollContainer.length>0,wrappedContainer=!1,$wrapper=$([]),absoluteToFixedOnScroll=9>=ieVersion&&!locked&&useAbsolutePositioning,$floatTable=$("<table/>"),$floatColGroup=$("<colgroup/>"),$tableColGroup=$table.find("colgroup:first"),existingColGroup=!0;0==$tableColGroup.length&&($tableColGroup=$("<colgroup/>"),existingColGroup=!1);var $fthRow=$('<fthrow style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"/>'),$floatContainer=$('<div style="overflow: hidden;"></div>'),floatTableHidden=!1,$newHeader=$("<thead/>"),$sizerRow=$('<tr class="size-row"/>'),$sizerCells=$([]),$tableCells=$([]),$headerCells=$([]),$fthCells=$([]);$newHeader.append($sizerRow),$table.prepend($tableColGroup),isChrome&&($fthGrp.append($fthRow),$table.append($fthGrp)),$floatTable.append($floatColGroup),$floatContainer.append($floatTable),opts.copyTableClass&&$floatTable.attr("class",$table.attr("class")),$floatTable.attr({cellpadding:$table.attr("cellpadding"),cellspacing:$table.attr("cellspacing"),border:$table.attr("border")});var tableDisplayCss=$table.css("display");if($floatTable.css({borderCollapse:$table.css("borderCollapse"),border:$table.css("border"),display:tableDisplayCss}),"none"==tableDisplayCss&&(floatTableHidden=!0),$floatTable.addClass(opts.floatTableClass).css("margin",0),useAbsolutePositioning){var makeRelative=function($container,alwaysWrap){var positionCss=$container.css("position"),relativeToScrollContainer="relative"==positionCss||"absolute"==positionCss;if(!relativeToScrollContainer||alwaysWrap){var css={paddingLeft:$container.css("paddingLeft"),paddingRight:$container.css("paddingRight")};$floatContainer.css(css),$container=$container.wrap("<div class='"+opts.floatWrapperClass+"' style='position: relative; clear:both;'></div>").parent(),wrappedContainer=!0}return $container};locked?($wrapper=makeRelative($scrollContainer,!0),$wrapper.append($floatContainer)):($wrapper=makeRelative($table),$table.after($floatContainer))}else $table.after($floatContainer);$floatContainer.css({position:useAbsolutePositioning?"absolute":"fixed",marginTop:0,top:useAbsolutePositioning?0:"auto",zIndex:opts.zIndex}),$floatContainer.addClass(opts.floatContainerClass),updateScrollingOffsets();var layoutFixed={"table-layout":"fixed"},layoutAuto={"table-layout":$table.css("tableLayout")||"auto"},originalTableWidth=$table[0].style.width||"",originalTableMinWidth=$table.css("minWidth")||"";calculateScrollBarSize();var flow,ensureReflow=function(){(flow=reflow())()};ensureReflow();var calculateFloatContainerPos=calculateFloatContainerPosFn(),repositionFloatContainer=repositionFloatContainerFn();repositionFloatContainer(calculateFloatContainerPos("init"),!0);var windowScrollDoneEvent=util.debounce(function(){repositionFloatContainer(calculateFloatContainerPos("windowScrollDone"),!1)},300),windowScrollEvent=function(){repositionFloatContainer(calculateFloatContainerPos("windowScroll"),!1),windowScrollDoneEvent()},containerScrollEvent=function(){repositionFloatContainer(calculateFloatContainerPos("containerScroll"),!1)},windowResizeEvent=function(){updateScrollingOffsets(),calculateScrollBarSize(),ensureReflow(),calculateFloatContainerPos=calculateFloatContainerPosFn(),(repositionFloatContainer=repositionFloatContainerFn())(calculateFloatContainerPos("resize"),!0,!0)},reflowEvent=util.debounce(function(){calculateScrollBarSize(),updateScrollingOffsets(),ensureReflow(),calculateFloatContainerPos=calculateFloatContainerPosFn(),repositionFloatContainer(calculateFloatContainerPos("reflow"),!0)},1);locked?useAbsolutePositioning?$scrollContainer.on(eventName("scroll"),containerScrollEvent):($scrollContainer.on(eventName("scroll"),containerScrollEvent),$window.on(eventName("scroll"),windowScrollEvent)):$window.on(eventName("scroll"),windowScrollEvent),$window.on(eventName("load"),reflowEvent),windowResize(opts.debounceResizeMs,eventName("resize"),windowResizeEvent),$table.on("reflow",reflowEvent),isDatatable($table)&&$table.on("filter",reflowEvent).on("sort",reflowEvent).on("page",reflowEvent),$table.data("floatThead-attached",{destroy:function(){var ns=".fth-"+floatTheadId;unfloat(),$table.css(layoutAuto),$tableColGroup.remove(),isChrome&&$fthGrp.remove(),$newHeader.parent().length&&$newHeader.replaceWith($header),$table.off("reflow"),$scrollContainer.off(ns),wrappedContainer&&($scrollContainer.length?$scrollContainer.unwrap():$table.unwrap()),$table.css("minWidth",originalTableMinWidth),$floatContainer.remove(),$table.data("floatThead-attached",!1),
$window.off(ns)},reflow:function(){reflowEvent()},setHeaderHeight:function(){setHeaderHeight()},getFloatContainer:function(){return $floatContainer},getRowGroups:function(){return headerFloated?$floatContainer.find("thead").add($table.find("tbody,tfoot")):$table.find("thead,tbody,tfoot")}})}),this}}(jQuery),function(){$.floatThead=$.floatThead||{},$.floatThead._=window._||function(){var that={},hasOwnProperty=Object.prototype.hasOwnProperty,isThings=["Arguments","Function","String","Number","Date","RegExp"];that.has=function(obj,key){return hasOwnProperty.call(obj,key)},that.keys=function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)that.has(obj,key)&&keys.push(key);return keys};var idCounter=0;return that.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},$.each(isThings,function(){var name=this;that["is"+name]=function(obj){return Object.prototype.toString.call(obj)=="[object "+name+"]"}}),that.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;return function(){context=this,args=arguments,timestamp=new Date;var later=function(){var last=new Date-timestamp;wait>last?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args)))},callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args)),result}},that}()}(),function($){function fnPjax(selector,container,options){var context=this;return this.on("click.pjax",selector,function(event){var opts=$.extend({history:!0},optionsFor(container,options));opts.container||(opts.container=$(this).attr("data-pjax")||context),handleClick(event,opts)})}function handleClick(event,container,options){options=optionsFor(container,options);var link=event.currentTarget;if(0!=$(link).data("pjax")){if("A"!==link.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(event.which>1||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey||location.protocol!==link.protocol||location.hostname!==link.hostname||link.href.indexOf("#")>-1&&stripHash(link)==stripHash(location)||event.isDefaultPrevented())){var defaults={url:link.href,container:$(link).attr("data-pjax"),target:link},opts=$.extend({},defaults,options),clickEvent=$.Event("pjax:click");$(link).trigger(clickEvent,[opts]),clickEvent.isDefaultPrevented()||(pjax(opts),event.preventDefault(),$(link).trigger("pjax:clicked",[opts]))}}}function handleSubmit(event,container,options){options=optionsFor(container,options);var form=event.currentTarget;if("FORM"!==form.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var defaults={type:form.method.toUpperCase(),url:form.action,container:$(form).attr("data-pjax"),target:form};if("GET"!==defaults.type&&void 0!==window.FormData)defaults.data=new FormData(form),defaults.processData=!1,defaults.contentType=!1;else{if($(form).find(":file").length)return;defaults.data=$(form).serializeArray()}pjax($.extend({},defaults,options)),event.preventDefault()}function pjax(options){function fire(type,args,props){props||(props={}),props.relatedTarget=target;var event=$.Event(type,props);return context.trigger(event,args),!event.isDefaultPrevented()}options=$.extend(!0,{},$.ajaxSettings,pjax.defaults,options),$.isFunction(options.url)&&(options.url=options.url());var target=options.target,hash=parseURL(options.url).hash,context=options.context=findContainerFor(options.container);options.data||(options.data={}),$.isArray(options.data)?options.data.push({name:"_pjax",value:context.selector}):options.data._pjax=context.selector;var timeoutTimer;options.beforeSend=function(xhr,settings){if("GET"!==settings.type&&(settings.timeout=0),xhr.setRequestHeader("X-PJAX","true"),xhr.setRequestHeader("X-PJAX-Container",context.selector),!fire("pjax:beforeSend",[xhr,settings]))return!1;settings.timeout>0&&(timeoutTimer=setTimeout(function(){fire("pjax:timeout",[xhr,options])&&xhr.abort("timeout")},settings.timeout),settings.timeout=0);var url=parseURL(settings.url);url.hash=hash,options.requestUrl=stripInternalParams(url.href)},options.complete=function(xhr,textStatus){timeoutTimer&&clearTimeout(timeoutTimer),fire("pjax:complete",[xhr,textStatus,options]),fire("pjax:end",[xhr,options])},options.error=function(xhr,textStatus,errorThrown){var container=extractContainer("",xhr,options),redirect=xhr.status>=301&&xhr.status<=303,allowed=redirect||fire("pjax:error",[xhr,textStatus,errorThrown,options]);(redirect||"GET"==options.type&&"abort"!==textStatus&&allowed)&&locationReplace(container.url)},options.success=function(data,status,xhr){var previousState=pjax.state,currentVersion="function"==typeof $.pjax.defaults.version?$.pjax.defaults.version():$.pjax.defaults.version,latestVersion=xhr.getResponseHeader("X-PJAX-Version"),container=extractContainer(data,xhr,options),url=parseURL(container.url);if(hash&&(url.hash=hash,container.url=url.href),currentVersion&&latestVersion&&currentVersion!==latestVersion)return void locationReplace(container.url);if(!container.contents)return void locationReplace(container.url);pjax.state={id:options.id||uniqueId(),url:container.url,title:container.title,container:context.selector,fragment:options.fragment,timeout:options.timeout},options.history&&(options.push||options.replace)&&window.history.replaceState(pjax.state,container.title,container.url);try{document.activeElement.blur()}catch(e){}container.title&&(document.title=container.title),fire("pjax:beforeReplace",[container.contents,options],{state:pjax.state,previousState:previousState}),context.html(container.contents);var autofocusEl=context.find("input[autofocus], textarea[autofocus]").last()[0];autofocusEl&&document.activeElement!==autofocusEl&&autofocusEl.focus(),executeScriptTags(container.scripts);var scrollTo=options.scrollTo;if(hash){var name=decodeURIComponent(hash.slice(1)),target=document.getElementById(name)||document.getElementsByName(name)[0];target&&(scrollTo=$(target).offset().top)}"number"==typeof scrollTo&&$(window).scrollTop(scrollTo),fire("pjax:success",[data,status,xhr,options])},pjax.state||(pjax.state={id:uniqueId(),url:window.location.href,title:document.title,container:context.selector,fragment:options.fragment,timeout:options.timeout},window.history.replaceState(pjax.state,document.title)),abortXHR(pjax.xhr),options.url=stripInternalParams(options.url),pjax.options=options;var xhr=pjax.xhr=$.ajax(options);return xhr.readyState>0&&(options.history&&options.push&&!options.replace&&(cachePush(pjax.state.id,cloneContents(context)),window.history.pushState(null,"",options.requestUrl)),fire("pjax:start",[xhr,options]),fire("pjax:send",[xhr,options])),pjax.xhr}function pjaxReload(container,options){var defaults={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return pjax($.extend(defaults,optionsFor(container,options)))}function locationReplace(url){pjax.options.history&&(window.history.replaceState(null,"",pjax.state.url),window.location.replace(url))}function onPjaxPopstate(event){initialPop||abortXHR(pjax.xhr);var previousState=pjax.state,state=event.state;if(state&&state.container){if(initialPop&&initialURL==state.url)return;var direction,containerSelector=state.container;if(previousState){if(previousState.id===state.id)return;direction=previousState.id<state.id?"forward":"back","back"==direction&&(containerSelector=previousState.container)}var container=$(containerSelector);if(container.length){var contents=cacheMapping[state.id];previousState&&cachePop(direction,previousState.id,cloneContents(container));var popstateEvent=$.Event("pjax:popstate",{state:state,direction:direction});container.trigger(popstateEvent);var options={id:state.id,url:state.url,container:container,push:!1,fragment:state.fragment,timeout:state.timeout,scrollTo:!1};if(contents){container.trigger("pjax:start",[null,options]),pjax.state=state,state.title&&(document.title=state.title);var beforeReplaceEvent=$.Event("pjax:beforeReplace",{state:state,previousState:previousState});container.trigger(beforeReplaceEvent,[contents,options]),container.html(contents),container.trigger("pjax:end",[null,options])}else pjax(options);container[0].offsetHeight}else locationReplace(location.href)}initialPop=!1}function fallbackPjax(options){var url=$.isFunction(options.url)?options.url():options.url,method=options.type?options.type.toUpperCase():"GET",form=$("<form>",{method:"GET"===method?"GET":"POST",action:url,style:"display:none"});"GET"!==method&&"POST"!==method&&form.append($("<input>",{type:"hidden",name:"_method",value:method.toLowerCase()}));var data=options.data;if("string"==typeof data)$.each(data.split("&"),function(index,value){var pair=value.split("=");form.append($("<input>",{type:"hidden",name:pair[0],value:pair[1]}))});else if($.isArray(data))$.each(data,function(index,value){form.append($("<input>",{type:"hidden",name:value.name,value:value.value}))});else if("object"==typeof data){var key;for(key in data)form.append($("<input>",{type:"hidden",name:key,value:data[key]}))}$(document.body).append(form),form.submit()}function abortXHR(xhr){xhr&&xhr.readyState<4&&(xhr.onreadystatechange=$.noop,xhr.abort())}function uniqueId(){return(new Date).getTime()}function cloneContents(container){var cloned=container.clone();return cloned.find("script").each(function(){this.src||jQuery._data(this,"globalEval",!1)}),cloned.contents()}function stripParam(url,name){return url.replace(new RegExp("[?&]"+name+"=[^&#]*"),"").replace(/[?&]($|#)/,"").replace(/[?&]/,"?")}function stripInternalParams(url){return url=stripParam(url,"_pjax"),url=stripParam(url,"_")}function parseURL(url){var a=document.createElement("a");return a.href=url,a}function stripHash(location){return location.href.replace(/#.*/,"")}function optionsFor(container,options){return container&&options?options.container=container:options=$.isPlainObject(container)?container:{container:container},options.container&&(options.container=findContainerFor(options.container)),options}function findContainerFor(container){if(container=$(container),container.length){if(""!==container.selector&&container.context===document)return container;if(container.attr("id"))return $("#"+container.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+container.selector}function findAll(elems,selector){return elems.filter(selector).add(elems.find(selector))}function parseHTML(html){return $.parseHTML(html,document,!0)}function extractContainer(data,xhr,options){var obj={},fullDocument=/<html/i.test(data),serverUrl=xhr.getResponseHeader("X-PJAX-URL");if(obj.url=serverUrl?stripInternalParams(serverUrl):options.requestUrl,fullDocument)var $head=$(parseHTML(data.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),$body=$(parseHTML(data.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var $head=$body=$(parseHTML(data));if(0===$body.length)return obj;if(obj.title=findAll($head,"title").last().text(),options.fragment){if("body"===options.fragment)var $fragment=$body;else var $fragment=findAll($body,options.fragment).first();$fragment.length&&(obj.contents="body"===options.fragment?$fragment:$fragment.contents(),obj.title||(obj.title=$fragment.attr("title")||$fragment.data("title")))}else fullDocument||(obj.contents=$body);return obj.contents&&(obj.contents=obj.contents.not(function(){return $(this).is("title")}),obj.contents.find("title").remove(),obj.scripts=findAll(obj.contents,"script[src]").remove(),obj.contents=obj.contents.not(obj.scripts)),obj.title&&(obj.title=$.trim(obj.title)),obj}function executeScriptTags(scripts){if(scripts){var existingScripts=$("script[src]");scripts.each(function(){var src=this.src,matchedScripts=existingScripts.filter(function(){return this.src===src});if(!matchedScripts.length){var script=document.createElement("script"),type=$(this).attr("type");type&&(script.type=type),script.src=$(this).attr("src"),document.head.appendChild(script)}})}}function cachePush(id,value){pjax.options.cache&&(cacheMapping[id]=value,cacheBackStack.push(id),trimCacheStack(cacheForwardStack,0),trimCacheStack(cacheBackStack,pjax.defaults.maxCacheLength))}function cachePop(direction,id,value){if(pjax.options.cache){var pushStack,popStack;cacheMapping[id]=value,"forward"===direction?(pushStack=cacheBackStack,popStack=cacheForwardStack):(pushStack=cacheForwardStack,popStack=cacheBackStack),pushStack.push(id),(id=popStack.pop())&&delete cacheMapping[id],trimCacheStack(pushStack,pjax.defaults.maxCacheLength)}}function trimCacheStack(stack,length){for(;stack.length>length;)delete cacheMapping[stack.shift()]}function findVersion(){return $("meta").filter(function(){var name=$(this).attr("http-equiv");return name&&"X-PJAX-VERSION"===name.toUpperCase()}).attr("content")}function enable(){$.fn.pjax=fnPjax,$.pjax=pjax,$.pjax.enable=$.noop,$.pjax.disable=disable,$.pjax.click=handleClick,$.pjax.submit=handleSubmit,$.pjax.reload=pjaxReload,$.pjax.defaults={history:!0,cache:!0,timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:findVersion},$(window).on("popstate.pjax",onPjaxPopstate)}function disable(){$.fn.pjax=function(){return this},$.pjax=fallbackPjax,$.pjax.enable=enable,$.pjax.disable=$.noop,$.pjax.click=$.noop,$.pjax.submit=$.noop,$.pjax.reload=function(){window.location.reload()},$(window).off("popstate.pjax",onPjaxPopstate)}var initialPop=!0,initialURL=window.location.href,initialState=window.history.state;initialState&&initialState.container&&(pjax.state=initialState),"state"in window.history&&(initialPop=!1);var cacheMapping={},cacheForwardStack=[],cacheBackStack=[];$.inArray("state",$.event.props)<0&&$.event.props.push("state"),$.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),$.support.pjax?enable():disable()}(jQuery);